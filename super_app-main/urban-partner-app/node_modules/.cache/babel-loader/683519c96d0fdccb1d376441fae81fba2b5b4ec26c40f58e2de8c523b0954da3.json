{"ast":null,"code":"import api from './api';\nclass PaymentService {\n  constructor() {\n    this.razorpay = null;\n    this.initializeRazorpay();\n  }\n  initializeRazorpay() {\n    if (typeof window !== 'undefined' && !window.Razorpay) {\n      const script = document.createElement('script');\n      script.src = 'https://checkout.razorpay.com/v1/checkout.js';\n      script.async = true;\n      script.onload = () => console.log('✅ Razorpay SDK loaded');\n      script.onerror = () => console.error('❌ Failed to load Razorpay SDK');\n      document.head.appendChild(script);\n    }\n  }\n  async getRazorpayKey() {\n    try {\n      const response = await api.get('/payments/razorpay-key');\n      if (response.data.success) {\n        return response.data.data.key_id;\n      }\n      return null;\n    } catch (error) {\n      console.error('Error getting Razorpay key:', error);\n      return null;\n    }\n  }\n  async createRazorpayOrder(paymentData) {\n    try {\n      const response = await api.post('/payments/create-order', paymentData);\n      return response.data;\n    } catch (error) {\n      console.error('Error creating Razorpay order:', error);\n      throw error;\n    }\n  }\n  async verifyPayment(verificationData) {\n    try {\n      const response = await api.post('/payments/verify', verificationData);\n      return response.data;\n    } catch (error) {\n      console.error('Error verifying payment:', error);\n      throw error;\n    }\n  }\n  async processPayment(orderData, options = {}) {\n    try {\n      const razorpayKey = await this.getRazorpayKey();\n      if (!razorpayKey) {\n        throw new Error('Payment service is currently unavailable');\n      }\n      const orderResponse = await this.createRazorpayOrder({\n        amount: orderData.amount,\n        currency: orderData.currency || 'INR',\n        order_id: orderData.order_id,\n        order_model: 'ServiceBooking',\n        description: orderData.description || 'Urban Service Payment',\n        email: orderData.email || 'customer@example.com',\n        contact: orderData.contact || '9876543210'\n      });\n      if (!orderResponse.success) {\n        throw new Error('Failed to create payment order');\n      }\n      const {\n        razorpayOrder,\n        payment\n      } = orderResponse.data;\n      const paymentOptions = {\n        key: razorpayKey,\n        amount: razorpayOrder.amount,\n        currency: razorpayOrder.currency,\n        name: options.businessName || 'Urban Partner',\n        description: orderData.description || 'Payment for service',\n        order_id: razorpayOrder.id,\n        handler: async response => {\n          try {\n            const verificationData = {\n              razorpay_payment_id: response.razorpay_payment_id,\n              razorpay_order_id: response.razorpay_order_id,\n              razorpay_signature: response.razorpay_signature,\n              payment_id: payment._id\n            };\n            const verificationResponse = await this.verifyPayment(verificationData);\n            if (verificationResponse.success) {\n              if (options.onSuccess) options.onSuccess(verificationResponse.data);\n            } else {\n              throw new Error('Payment verification failed');\n            }\n          } catch (error) {\n            if (options.onError) options.onError(error);\n          }\n        },\n        prefill: {\n          name: orderData.customerName || '',\n          email: orderData.email || '',\n          contact: orderData.contact || ''\n        },\n        theme: {\n          color: options.themeColor || '#3b82f6'\n        },\n        modal: {\n          ondismiss: () => {\n            if (options.onCancel) options.onCancel();\n          }\n        }\n      };\n      const rzp = new window.Razorpay(paymentOptions);\n      rzp.open();\n    } catch (error) {\n      console.error('Payment processing error:', error);\n      if (options.onError) options.onError(error);\n      throw error;\n    }\n  }\n}\nexport default new PaymentService();","map":{"version":3,"names":["api","PaymentService","constructor","razorpay","initializeRazorpay","window","Razorpay","script","document","createElement","src","async","onload","console","log","onerror","error","head","appendChild","getRazorpayKey","response","get","data","success","key_id","createRazorpayOrder","paymentData","post","verifyPayment","verificationData","processPayment","orderData","options","razorpayKey","Error","orderResponse","amount","currency","order_id","order_model","description","email","contact","razorpayOrder","payment","paymentOptions","key","name","businessName","id","handler","razorpay_payment_id","razorpay_order_id","razorpay_signature","payment_id","_id","verificationResponse","onSuccess","onError","prefill","customerName","theme","color","themeColor","modal","ondismiss","onCancel","rzp","open"],"sources":["C:/Users/karthip/Downloads/super_app-main-5 (1)/super_app-main-5/super_app-main/urban-partner-app/src/services/paymentService.js"],"sourcesContent":["import api from './api';\r\n\r\nclass PaymentService {\r\n    constructor() {\r\n        this.razorpay = null;\r\n        this.initializeRazorpay();\r\n    }\r\n\r\n    initializeRazorpay() {\r\n        if (typeof window !== 'undefined' && !window.Razorpay) {\r\n            const script = document.createElement('script');\r\n            script.src = 'https://checkout.razorpay.com/v1/checkout.js';\r\n            script.async = true;\r\n            script.onload = () => console.log('✅ Razorpay SDK loaded');\r\n            script.onerror = () => console.error('❌ Failed to load Razorpay SDK');\r\n            document.head.appendChild(script);\r\n        }\r\n    }\r\n\r\n    async getRazorpayKey() {\r\n        try {\r\n            const response = await api.get('/payments/razorpay-key');\r\n            if (response.data.success) {\r\n                return response.data.data.key_id;\r\n            }\r\n            return null;\r\n        } catch (error) {\r\n            console.error('Error getting Razorpay key:', error);\r\n            return null;\r\n        }\r\n    }\r\n\r\n    async createRazorpayOrder(paymentData) {\r\n        try {\r\n            const response = await api.post('/payments/create-order', paymentData);\r\n            return response.data;\r\n        } catch (error) {\r\n            console.error('Error creating Razorpay order:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async verifyPayment(verificationData) {\r\n        try {\r\n            const response = await api.post('/payments/verify', verificationData);\r\n            return response.data;\r\n        } catch (error) {\r\n            console.error('Error verifying payment:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async processPayment(orderData, options = {}) {\r\n        try {\r\n            const razorpayKey = await this.getRazorpayKey();\r\n            if (!razorpayKey) {\r\n                throw new Error('Payment service is currently unavailable');\r\n            }\r\n\r\n            const orderResponse = await this.createRazorpayOrder({\r\n                amount: orderData.amount,\r\n                currency: orderData.currency || 'INR',\r\n                order_id: orderData.order_id,\r\n                order_model: 'ServiceBooking',\r\n                description: orderData.description || 'Urban Service Payment',\r\n                email: orderData.email || 'customer@example.com',\r\n                contact: orderData.contact || '9876543210'\r\n            });\r\n\r\n            if (!orderResponse.success) {\r\n                throw new Error('Failed to create payment order');\r\n            }\r\n\r\n            const { razorpayOrder, payment } = orderResponse.data;\r\n\r\n            const paymentOptions = {\r\n                key: razorpayKey,\r\n                amount: razorpayOrder.amount,\r\n                currency: razorpayOrder.currency,\r\n                name: options.businessName || 'Urban Partner',\r\n                description: orderData.description || 'Payment for service',\r\n                order_id: razorpayOrder.id,\r\n                handler: async (response) => {\r\n                    try {\r\n                        const verificationData = {\r\n                            razorpay_payment_id: response.razorpay_payment_id,\r\n                            razorpay_order_id: response.razorpay_order_id,\r\n                            razorpay_signature: response.razorpay_signature,\r\n                            payment_id: payment._id\r\n                        };\r\n\r\n                        const verificationResponse = await this.verifyPayment(verificationData);\r\n                        if (verificationResponse.success) {\r\n                            if (options.onSuccess) options.onSuccess(verificationResponse.data);\r\n                        } else {\r\n                            throw new Error('Payment verification failed');\r\n                        }\r\n                    } catch (error) {\r\n                        if (options.onError) options.onError(error);\r\n                    }\r\n                },\r\n                prefill: {\r\n                    name: orderData.customerName || '',\r\n                    email: orderData.email || '',\r\n                    contact: orderData.contact || ''\r\n                },\r\n                theme: {\r\n                    color: options.themeColor || '#3b82f6'\r\n                },\r\n                modal: {\r\n                    ondismiss: () => {\r\n                        if (options.onCancel) options.onCancel();\r\n                    }\r\n                }\r\n            };\r\n\r\n            const rzp = new window.Razorpay(paymentOptions);\r\n            rzp.open();\r\n\r\n        } catch (error) {\r\n            console.error('Payment processing error:', error);\r\n            if (options.onError) options.onError(error);\r\n            throw error;\r\n        }\r\n    }\r\n}\r\n\r\nexport default new PaymentService();\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}