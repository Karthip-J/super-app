{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = 'http://localhost:5000/api/urban-services';\nconst URBAN_SERVICES_URL = 'http://localhost:5000/api/urban-services';\nconst getAuthHeaders = () => ({\n  'Authorization': `Bearer ${localStorage.getItem('token') || localStorage.getItem('authToken')}`,\n  'Content-Type': 'application/json'\n});\nexport const partnerService = {\n  // Get partner's bookings\n  getBookings: async (status = '') => {\n    try {\n      const response = await axios.get(`${URBAN_SERVICES_URL}/partner/bookings${status ? `?status=${status}` : ''}`, {\n        headers: getAuthHeaders()\n      });\n      return response.data.data || [];\n    } catch (error) {\n      console.error('Error fetching bookings:', error);\n      // Return empty array instead of throwing to prevent UI errors\n      return [];\n    }\n  },\n  // Accept a booking\n  acceptBooking: async bookingId => {\n    try {\n      const response = await axios.put(`${URBAN_SERVICES_URL}/bookings/${bookingId}/status`, {\n        status: 'confirmed'\n      }, {\n        headers: getAuthHeaders()\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error accepting booking:', error);\n      throw error;\n    }\n  },\n  // Reject a booking\n  rejectBooking: async (bookingId, reason = '') => {\n    try {\n      const response = await axios.put(`${URBAN_SERVICES_URL}/bookings/${bookingId}/status`, {\n        status: 'rejected',\n        cancellationReason: reason || 'Partner rejected the booking'\n      }, {\n        headers: getAuthHeaders()\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error rejecting booking:', error);\n      throw error;\n    }\n  },\n  // Update booking status\n  updateBookingStatus: async (bookingId, status) => {\n    try {\n      const response = await axios.put(`${URBAN_SERVICES_URL}/bookings/${bookingId}/status`, {\n        status\n      }, {\n        headers: getAuthHeaders()\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error updating booking status:', error);\n      throw error;\n    }\n  },\n  // Get partner profile\n  getProfile: async () => {\n    try {\n      const response = await axios.get(`${URBAN_SERVICES_URL}/partner/profile`, {\n        headers: getAuthHeaders()\n      });\n      return response.data.data || {};\n    } catch (error) {\n      console.error('Error fetching partner profile:', error);\n      return {};\n    }\n  },\n  // Get partner stats\n  getStats: async () => {\n    try {\n      // Get partner's bookings to calculate stats\n      const [bookingsResponse, partnerResponse] = await Promise.all([axios.get(`${URBAN_SERVICES_URL}/partner/bookings`, {\n        headers: getAuthHeaders()\n      }), axios.get(`${URBAN_SERVICES_URL}/partner/profile`, {\n        headers: getAuthHeaders()\n      })]);\n      const bookings = bookingsResponse.data.data || [];\n      const partner = partnerResponse.data.data || {};\n\n      // Calculate stats from bookings\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      const todayEarnings = bookings.filter(booking => booking.status === 'completed' && new Date(booking.updatedAt) >= today).reduce((sum, booking) => {\n        var _booking$pricing;\n        return sum + (((_booking$pricing = booking.pricing) === null || _booking$pricing === void 0 ? void 0 : _booking$pricing.totalAmount) || 0);\n      }, 0);\n      const totalEarnings = bookings.filter(booking => booking.status === 'completed').reduce((sum, booking) => {\n        var _booking$pricing2;\n        return sum + (((_booking$pricing2 = booking.pricing) === null || _booking$pricing2 === void 0 ? void 0 : _booking$pricing2.totalAmount) || 0);\n      }, 0);\n      const pendingBookings = bookings.filter(b => b.status === 'pending').length;\n      const completedBookings = bookings.filter(b => b.status === 'completed').length;\n      return {\n        totalBookings: bookings.length,\n        completedBookings,\n        pendingBookings,\n        todayEarnings,\n        totalEarnings,\n        averageRating: partner.rating || 0\n      };\n    } catch (error) {\n      console.error('Error calculating partner stats:', error);\n      // Return default values\n      return {\n        totalBookings: 0,\n        completedBookings: 0,\n        pendingBookings: 0,\n        todayEarnings: 0,\n        totalEarnings: 0,\n        averageRating: 0\n      };\n    }\n  }\n};\nexport default partnerService;","map":{"version":3,"names":["axios","API_BASE_URL","URBAN_SERVICES_URL","getAuthHeaders","localStorage","getItem","partnerService","getBookings","status","response","get","headers","data","error","console","acceptBooking","bookingId","put","rejectBooking","reason","cancellationReason","updateBookingStatus","getProfile","getStats","bookingsResponse","partnerResponse","Promise","all","bookings","partner","today","Date","setHours","todayEarnings","filter","booking","updatedAt","reduce","sum","_booking$pricing","pricing","totalAmount","totalEarnings","_booking$pricing2","pendingBookings","b","length","completedBookings","totalBookings","averageRating","rating"],"sources":["D:/SUPER APP MAIN NEW/SUPER APP MAIN NEW/super_app-main/urban-partner-app/src/services/partnerService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = 'http://localhost:5000/api/urban-services';\r\nconst URBAN_SERVICES_URL = 'http://localhost:5000/api/urban-services';\r\n\r\nconst getAuthHeaders = () => ({\r\n  'Authorization': `Bearer ${localStorage.getItem('token') || localStorage.getItem('authToken')}`,\r\n  'Content-Type': 'application/json'\r\n});\r\n\r\nexport const partnerService = {\r\n  // Get partner's bookings\r\n  getBookings: async (status = '') => {\r\n    try {\r\n      const response = await axios.get(\r\n        `${URBAN_SERVICES_URL}/partner/bookings${status ? `?status=${status}` : ''}`,\r\n        { headers: getAuthHeaders() }\r\n      );\r\n      return response.data.data || [];\r\n    } catch (error) {\r\n      console.error('Error fetching bookings:', error);\r\n      // Return empty array instead of throwing to prevent UI errors\r\n      return [];\r\n    }\r\n  },\r\n\r\n  // Accept a booking\r\n  acceptBooking: async (bookingId) => {\r\n    try {\r\n      const response = await axios.put(\r\n        `${URBAN_SERVICES_URL}/bookings/${bookingId}/status`,\r\n        { status: 'confirmed' },\r\n        { headers: getAuthHeaders() }\r\n      );\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error accepting booking:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Reject a booking\r\n  rejectBooking: async (bookingId, reason = '') => {\r\n    try {\r\n      const response = await axios.put(\r\n        `${URBAN_SERVICES_URL}/bookings/${bookingId}/status`,\r\n        { \r\n          status: 'rejected',\r\n          cancellationReason: reason || 'Partner rejected the booking'\r\n        },\r\n        { headers: getAuthHeaders() }\r\n      );\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error rejecting booking:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Update booking status\r\n  updateBookingStatus: async (bookingId, status) => {\r\n    try {\r\n      const response = await axios.put(\r\n        `${URBAN_SERVICES_URL}/bookings/${bookingId}/status`,\r\n        { status },\r\n        { headers: getAuthHeaders() }\r\n      );\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error updating booking status:', error);\r\n      throw error;\r\n    }\r\n  },\r\n  \r\n  // Get partner profile\r\n  getProfile: async () => {\r\n    try {\r\n      const response = await axios.get(\r\n        `${URBAN_SERVICES_URL}/partner/profile`,\r\n        { headers: getAuthHeaders() }\r\n      );\r\n      return response.data.data || {};\r\n    } catch (error) {\r\n      console.error('Error fetching partner profile:', error);\r\n      return {};\r\n    }\r\n  },\r\n  \r\n  // Get partner stats\r\n  getStats: async () => {\r\n    try {\r\n      // Get partner's bookings to calculate stats\r\n      const [bookingsResponse, partnerResponse] = await Promise.all([\r\n        axios.get(`${URBAN_SERVICES_URL}/partner/bookings`, { \r\n          headers: getAuthHeaders() \r\n        }),\r\n        axios.get(`${URBAN_SERVICES_URL}/partner/profile`, {\r\n          headers: getAuthHeaders()\r\n        })\r\n      ]);\r\n\r\n      const bookings = bookingsResponse.data.data || [];\r\n      const partner = partnerResponse.data.data || {};\r\n      \r\n      // Calculate stats from bookings\r\n      const today = new Date();\r\n      today.setHours(0, 0, 0, 0);\r\n      \r\n      const todayEarnings = bookings\r\n        .filter(booking => \r\n          booking.status === 'completed' && \r\n          new Date(booking.updatedAt) >= today\r\n        )\r\n        .reduce((sum, booking) => sum + (booking.pricing?.totalAmount || 0), 0);\r\n      \r\n      const totalEarnings = bookings\r\n        .filter(booking => booking.status === 'completed')\r\n        .reduce((sum, booking) => sum + (booking.pricing?.totalAmount || 0), 0);\r\n      \r\n      const pendingBookings = bookings.filter(b => b.status === 'pending').length;\r\n      const completedBookings = bookings.filter(b => b.status === 'completed').length;\r\n      \r\n      return {\r\n        totalBookings: bookings.length,\r\n        completedBookings,\r\n        pendingBookings,\r\n        todayEarnings,\r\n        totalEarnings,\r\n        averageRating: partner.rating || 0\r\n      };\r\n    } catch (error) {\r\n      console.error('Error calculating partner stats:', error);\r\n      // Return default values\r\n      return {\r\n        totalBookings: 0,\r\n        completedBookings: 0,\r\n        pendingBookings: 0,\r\n        todayEarnings: 0,\r\n        totalEarnings: 0,\r\n        averageRating: 0\r\n      };\r\n    }\r\n  }\r\n};\r\n\r\nexport default partnerService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}