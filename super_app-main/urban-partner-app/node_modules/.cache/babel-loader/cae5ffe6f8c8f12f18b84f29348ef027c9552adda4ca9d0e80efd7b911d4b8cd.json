{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\THILOCIGAN\\\\Documents\\\\super_app-main_2\\\\super_app-main\\\\urban-partner-app\\\\src\\\\components\\\\Partner\\\\ServiceInProgress.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport partnerService from '../../services/partnerService';\nimport Navbar from '../common/Navbar';\nimport bikeAnimation from '../../assets/bike_animation.mp4';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ServiceInProgress = () => {\n  _s();\n  const {\n    bookingId\n  } = useParams();\n  const navigate = useNavigate();\n  const [booking, setBooking] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const canvasRef = React.useRef(null);\n  const videoRef = React.useRef(null);\n  // Removed gears refs as we are switching to SVG\n\n  // Bike Animation Loop (Existing)\n  useEffect(() => {\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    if (!video || !canvas) return;\n    const ctx = canvas.getContext('2d', {\n      willReadFrequently: true\n    });\n    let animationFrameId;\n    const renderFrame = () => {\n      if (video.paused || video.ended) return;\n      if (canvas.width !== 320) {\n        canvas.width = 320;\n        canvas.height = 180;\n      }\n      ctx.save();\n      ctx.scale(-1, 1);\n      ctx.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);\n      ctx.restore();\n      const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      const data = frame.data;\n      const l = data.length / 4;\n      for (let i = 0; i < l; i++) {\n        let r = data[i * 4 + 0];\n        let g = data[i * 4 + 1];\n        let b = data[i * 4 + 2];\n\n        // Green Scan Removal\n        if (g > 90 && g > r * 1.1 && g > b * 1.1) {\n          data[i * 4 + 3] = 0;\n          continue;\n        }\n        // Red to Blue\n        if (r > g * 1.4 && r > b * 1.4 && r > 50) {\n          data[i * 4 + 0] = 37;\n          data[i * 4 + 1] = g + 50;\n          if (data[i * 4 + 1] > 255) data[i * 4 + 1] = 255;\n          data[i * 4 + 2] = r;\n        }\n      }\n      ctx.putImageData(frame, 0, 0);\n      animationFrameId = requestAnimationFrame(renderFrame);\n    };\n    const onPlay = () => renderFrame();\n    video.addEventListener('play', onPlay);\n    if (video.readyState >= 2) video.play().catch(e => console.log(\"Video play failed\", e));else video.oncanplay = () => video.play().catch(e => console.log(\"Video play failed\", e));\n    return () => {\n      cancelAnimationFrame(animationFrameId);\n      video.removeEventListener('play', onPlay);\n    };\n  }, []);\n\n  // Fetch booking details on mount and correct status if needed\n  useEffect(() => {\n    const fetchAndCorrectBooking = async () => {\n      try {\n        const response = await partnerService.getBookingById(bookingId);\n        const fetchedBooking = response.data;\n        setBooking(fetchedBooking);\n\n        // If status is 'on_the_way', we must update to 'in_progress' because we are on the active service page\n        if (fetchedBooking.status === 'on_the_way') {\n          await partnerService.updateBookingStatus(bookingId, 'in_progress');\n          setBooking(prev => ({\n            ...prev,\n            status: 'in_progress'\n          }));\n        }\n      } catch (err) {\n        console.error('Error fetching/correcting booking:', err);\n        // Don't show error immediately, allow user to try \"Mark Completed\" which might work or fail with more info\n      }\n    };\n    fetchAndCorrectBooking();\n  }, [bookingId]);\n  const handleCompleteService = async () => {\n    try {\n      setLoading(true);\n      await partnerService.updateBookingStatus(bookingId, 'completed');\n      setLoading(false);\n      navigate('/dashboard'); // Go back to dashboard after completion\n    } catch (err) {\n      console.error('Error completing service:', err);\n      // Fallback: If error is restricted transition, try force updating to in_progress first\n      if (err.response && err.response.status === 400 && (booking === null || booking === void 0 ? void 0 : booking.status) !== 'in_progress') {\n        try {\n          await partnerService.updateBookingStatus(bookingId, 'in_progress');\n          await partnerService.updateBookingStatus(bookingId, 'completed');\n          setLoading(false);\n          navigate('/dashboard');\n          return;\n        } catch (retryErr) {\n          console.error('Retry failed:', retryErr);\n        }\n      }\n      setError('Failed to list service as completed. Please try again.');\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-50 flex flex-col\",\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-grow flex flex-col items-center justify-center p-6 space-y-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative w-full h-40 flex items-center justify-center overflow-hidden mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute animate-drive-pass flex items-center justify-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute left-0 top-20 opacity-60 z-0 transform rotate-6 scale-75\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              width: \"80\",\n              height: \"50\",\n              viewBox: \"0 0 100 60\",\n              fill: \"none\",\n              className: \"text-gray-400\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M100 30 C 80 40, 60 20, 40 30 C 30 35, 20 25, 10 30 C 5 32, 0 28, 0 35 L 0 45 C 10 40, 30 50, 50 40 C 70 30, 90 35, 100 30 Z\",\n                fill: \"url(#smokeGradient)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"defs\", {\n                children: /*#__PURE__*/_jsxDEV(\"linearGradient\", {\n                  id: \"smokeGradient\",\n                  x1: \"0\",\n                  y1: \"0\",\n                  x2: \"1\",\n                  y2: \"0\",\n                  children: [/*#__PURE__*/_jsxDEV(\"stop\", {\n                    offset: \"0%\",\n                    stopColor: \"currentColor\",\n                    stopOpacity: \"0\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 135,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"stop\", {\n                    offset: \"100%\",\n                    stopColor: \"currentColor\",\n                    stopOpacity: \"0.8\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 136,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: videoRef,\n            src: bikeAnimation,\n            muted: true,\n            loop: true,\n            playsInline: true,\n            className: \"hidden\" // Hiding the raw video\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n            ref: canvasRef,\n            className: \"w-48 h-32 object-contain drop-shadow-lg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute animate-cogs-pop flex items-center justify-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative w-48 h-48 flex items-center justify-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              width: \"0\",\n              height: \"0\",\n              children: /*#__PURE__*/_jsxDEV(\"defs\", {\n                children: /*#__PURE__*/_jsxDEV(\"linearGradient\", {\n                  id: \"metalGradient\",\n                  x1: \"0%\",\n                  y1: \"0%\",\n                  x2: \"100%\",\n                  y2: \"100%\",\n                  children: [/*#__PURE__*/_jsxDEV(\"stop\", {\n                    offset: \"0%\",\n                    stopColor: \"#dbeafe\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 164,\n                    columnNumber: 41\n                  }, this), \" \", /*#__PURE__*/_jsxDEV(\"stop\", {\n                    offset: \"50%\",\n                    stopColor: \"#3b82f6\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 165,\n                    columnNumber: 41\n                  }, this), \" \", /*#__PURE__*/_jsxDEV(\"stop\", {\n                    offset: \"100%\",\n                    stopColor: \"#1e40af\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 41\n                  }, this), \" \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute left-[calc(50%-60px)] top-[calc(50%-60px)] animate-spin\",\n              style: {\n                animationDuration: '4s',\n                animationDirection: 'reverse'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"80\",\n                height: \"80\",\n                viewBox: \"0 0 100 100\",\n                className: \"drop-shadow-md\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  fill: \"url(#metalGradient)\",\n                  d: \"M50 0 L58 10 L70 5 L75 18 L88 15 L88 28 L98 32 L92 42 L100 50 L92 58 L98 68 L88 72 L88 85 L75 82 L70 95 L58 90 L50 100 L42 90 L30 95 L25 82 L12 85 L12 72 L2 68 L8 58 L0 50 L8 42 L2 32 L12 28 L12 15 L25 18 L30 5 L42 10 Z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"50\",\n                  cy: \"50\",\n                  r: \"15\",\n                  fill: \"#f8fafc\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"50\",\n                  cy: \"50\",\n                  r: \"8\",\n                  fill: \"#94a3b8\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute left-[calc(50%-20px)] top-[calc(50%-20px)] z-10 animate-spin\",\n              style: {\n                animationDuration: '3s'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"40\",\n                height: \"40\",\n                viewBox: \"0 0 100 100\",\n                className: \"drop-shadow-md\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  fill: \"url(#metalGradient)\",\n                  d: \"M50 0 L58 10 L70 5 L75 18 L88 15 L88 28 L98 32 L92 42 L100 50 L92 58 L98 68 L88 72 L88 85 L75 82 L70 95 L58 90 L50 100 L42 90 L30 95 L25 82 L12 85 L12 72 L2 68 L8 58 L0 50 L8 42 L2 32 L12 28 L12 15 L25 18 L30 5 L42 10 Z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"50\",\n                  cy: \"50\",\n                  r: \"12\",\n                  fill: \"#f8fafc\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"50\",\n                  cy: \"50\",\n                  r: \"6\",\n                  fill: \"#94a3b8\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute left-[calc(50%+15px)] top-[calc(50%+15px)] animate-spin\",\n              style: {\n                animationDuration: '4s',\n                animationDirection: 'reverse'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"60\",\n                height: \"60\",\n                viewBox: \"0 0 100 100\",\n                className: \"drop-shadow-md\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  fill: \"url(#metalGradient)\",\n                  d: \"M50 0 L58 10 L70 5 L75 18 L88 15 L88 28 L98 32 L92 42 L100 50 L92 58 L98 68 L88 72 L88 85 L75 82 L70 95 L58 90 L50 100 L42 90 L30 95 L25 82 L12 85 L12 72 L2 68 L8 58 L0 50 L8 42 L2 32 L12 28 L12 15 L25 18 L30 5 L42 10 Z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 192,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"50\",\n                  cy: \"50\",\n                  r: \"15\",\n                  fill: \"#f8fafc\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"50\",\n                  cy: \"50\",\n                  r: \"8\",\n                  fill: \"#94a3b8\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"absolute -bottom-6 text-sm font-semibold text-blue-500 animate-pulse\",\n            children: \"Processing...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-900\",\n          children: \"Service in Progress\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-500\",\n          children: \"Please complete the service requested by the customer.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full max-w-md space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between text-xs text-gray-400 font-semibold uppercase tracking-wider\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Started\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"In Progress\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-4 bg-gray-200 rounded-full overflow-hidden relative\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-0 left-0 bottom-0 bg-blue-600 w-full animate-progress-stripes bg-[length:40px_40px] bg-gradient-to-r from-blue-500 via-blue-600 to-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-0 left-0 h-full bg-blue-500 animate-[pulse_2s_cubic-bezier(0.4,0,0.6,1)_infinite] w-full origin-left\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-center text-sm text-blue-600 font-medium animate-pulse\",\n          children: \"Running...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 17\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 bg-red-50 text-red-700 rounded-md\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full max-w-md pt-8\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCompleteService,\n          disabled: loading,\n          className: \"w-full flex items-center justify-center px-6 py-4 border border-transparent text-lg font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 shadow-xl transition-transform transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed\",\n          children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",\n              xmlns: \"http://www.w3.org/2000/svg\",\n              fill: \"none\",\n              viewBox: \"0 0 24 24\",\n              children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                className: \"opacity-25\",\n                cx: \"12\",\n                cy: \"12\",\n                r: \"10\",\n                stroke: \"currentColor\",\n                strokeWidth: \"4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                className: \"opacity-75\",\n                fill: \"currentColor\",\n                d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 33\n            }, this), \"Completing...\"]\n          }, void 0, true) : 'Mark Service As Completed'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 9\n  }, this);\n};\n_s(ServiceInProgress, \"z1YuRw3GhlPmbdJkOSSTvrR0Ac8=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ServiceInProgress;\nexport default ServiceInProgress;\nvar _c;\n$RefreshReg$(_c, \"ServiceInProgress\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","partnerService","Navbar","bikeAnimation","jsxDEV","_jsxDEV","Fragment","_Fragment","ServiceInProgress","_s","bookingId","navigate","booking","setBooking","loading","setLoading","error","setError","canvasRef","useRef","videoRef","video","current","canvas","ctx","getContext","willReadFrequently","animationFrameId","renderFrame","paused","ended","width","height","save","scale","drawImage","restore","frame","getImageData","data","l","length","i","r","g","b","putImageData","requestAnimationFrame","onPlay","addEventListener","readyState","play","catch","e","console","log","oncanplay","cancelAnimationFrame","removeEventListener","fetchAndCorrectBooking","response","getBookingById","fetchedBooking","status","updateBookingStatus","prev","err","handleCompleteService","retryErr","className","children","fileName","_jsxFileName","lineNumber","columnNumber","viewBox","fill","d","id","x1","y1","x2","y2","offset","stopColor","stopOpacity","ref","src","muted","loop","playsInline","style","animationDuration","animationDirection","cx","cy","onClick","disabled","xmlns","stroke","strokeWidth","_c","$RefreshReg$"],"sources":["C:/Users/THILOCIGAN/Documents/super_app-main_2/super_app-main/urban-partner-app/src/components/Partner/ServiceInProgress.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport partnerService from '../../services/partnerService';\r\nimport Navbar from '../common/Navbar';\r\nimport bikeAnimation from '../../assets/bike_animation.mp4';\r\n\r\nconst ServiceInProgress = () => {\r\n    const { bookingId } = useParams();\r\n    const navigate = useNavigate();\r\n    const [booking, setBooking] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState(null);\r\n\r\n    const canvasRef = React.useRef(null);\r\n    const videoRef = React.useRef(null);\r\n    // Removed gears refs as we are switching to SVG\r\n\r\n    // Bike Animation Loop (Existing)\r\n    useEffect(() => {\r\n        const video = videoRef.current;\r\n        const canvas = canvasRef.current;\r\n        if (!video || !canvas) return;\r\n\r\n        const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n        let animationFrameId;\r\n\r\n        const renderFrame = () => {\r\n            if (video.paused || video.ended) return;\r\n            if (canvas.width !== 320) { canvas.width = 320; canvas.height = 180; }\r\n\r\n            ctx.save();\r\n            ctx.scale(-1, 1);\r\n            ctx.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);\r\n            ctx.restore();\r\n\r\n            const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n            const data = frame.data;\r\n            const l = data.length / 4;\r\n\r\n            for (let i = 0; i < l; i++) {\r\n                let r = data[i * 4 + 0];\r\n                let g = data[i * 4 + 1];\r\n                let b = data[i * 4 + 2];\r\n\r\n                // Green Scan Removal\r\n                if (g > 90 && g > r * 1.1 && g > b * 1.1) {\r\n                    data[i * 4 + 3] = 0;\r\n                    continue;\r\n                }\r\n                // Red to Blue\r\n                if (r > g * 1.4 && r > b * 1.4 && r > 50) {\r\n                    data[i * 4 + 0] = 37;\r\n                    data[i * 4 + 1] = g + 50;\r\n                    if (data[i * 4 + 1] > 255) data[i * 4 + 1] = 255;\r\n                    data[i * 4 + 2] = r;\r\n                }\r\n            }\r\n            ctx.putImageData(frame, 0, 0);\r\n            animationFrameId = requestAnimationFrame(renderFrame);\r\n        };\r\n        const onPlay = () => renderFrame();\r\n        video.addEventListener('play', onPlay);\r\n        if (video.readyState >= 2) video.play().catch(e => console.log(\"Video play failed\", e));\r\n        else video.oncanplay = () => video.play().catch(e => console.log(\"Video play failed\", e));\r\n\r\n        return () => {\r\n            cancelAnimationFrame(animationFrameId);\r\n            video.removeEventListener('play', onPlay);\r\n        };\r\n    }, []);\r\n\r\n    // Fetch booking details on mount and correct status if needed\r\n    useEffect(() => {\r\n        const fetchAndCorrectBooking = async () => {\r\n            try {\r\n                const response = await partnerService.getBookingById(bookingId);\r\n                const fetchedBooking = response.data;\r\n                setBooking(fetchedBooking);\r\n\r\n                // If status is 'on_the_way', we must update to 'in_progress' because we are on the active service page\r\n                if (fetchedBooking.status === 'on_the_way') {\r\n                    await partnerService.updateBookingStatus(bookingId, 'in_progress');\r\n                    setBooking(prev => ({ ...prev, status: 'in_progress' }));\r\n                }\r\n            } catch (err) {\r\n                console.error('Error fetching/correcting booking:', err);\r\n                // Don't show error immediately, allow user to try \"Mark Completed\" which might work or fail with more info\r\n            }\r\n        };\r\n        fetchAndCorrectBooking();\r\n    }, [bookingId]);\r\n\r\n    const handleCompleteService = async () => {\r\n        try {\r\n            setLoading(true);\r\n            await partnerService.updateBookingStatus(bookingId, 'completed');\r\n            setLoading(false);\r\n            navigate('/dashboard'); // Go back to dashboard after completion\r\n        } catch (err) {\r\n            console.error('Error completing service:', err);\r\n            // Fallback: If error is restricted transition, try force updating to in_progress first\r\n            if (err.response && err.response.status === 400 && booking?.status !== 'in_progress') {\r\n                try {\r\n                    await partnerService.updateBookingStatus(bookingId, 'in_progress');\r\n                    await partnerService.updateBookingStatus(bookingId, 'completed');\r\n                    setLoading(false);\r\n                    navigate('/dashboard');\r\n                    return;\r\n                } catch (retryErr) {\r\n                    console.error('Retry failed:', retryErr);\r\n                }\r\n            }\r\n\r\n            setError('Failed to list service as completed. Please try again.');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50 flex flex-col\">\r\n            <Navbar />\r\n\r\n            <div className=\"flex-grow flex flex-col items-center justify-center p-6 space-y-8\">\r\n\r\n                {/* Bike & Cogs Loop Animation */}\r\n                <div className=\"relative w-full h-40 flex items-center justify-center overflow-hidden mb-6\">\r\n                    {/* 1. Bike Container - Drives Right & Disappears */}\r\n                    <div className=\"absolute animate-drive-pass flex items-center justify-center\">\r\n                        {/* Smoke / Speed Trail */}\r\n                        <div className=\"absolute left-0 top-20 opacity-60 z-0 transform rotate-6 scale-75\">\r\n                            <svg width=\"80\" height=\"50\" viewBox=\"0 0 100 60\" fill=\"none\" className=\"text-gray-400\">\r\n                                <path d=\"M100 30 C 80 40, 60 20, 40 30 C 30 35, 20 25, 10 30 C 5 32, 0 28, 0 35 L 0 45 C 10 40, 30 50, 50 40 C 70 30, 90 35, 100 30 Z\" fill=\"url(#smokeGradient)\" />\r\n                                <defs>\r\n                                    <linearGradient id=\"smokeGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"0\">\r\n                                        <stop offset=\"0%\" stopColor=\"currentColor\" stopOpacity=\"0\" />\r\n                                        <stop offset=\"100%\" stopColor=\"currentColor\" stopOpacity=\"0.8\" />\r\n                                    </linearGradient>\r\n                                </defs>\r\n                            </svg>\r\n                        </div>\r\n                        {/* Hidden Video Source */}\r\n                        <video\r\n                            ref={videoRef}\r\n                            src={bikeAnimation}\r\n                            muted\r\n                            loop\r\n                            playsInline\r\n                            className=\"hidden\" // Hiding the raw video\r\n                        />\r\n                        {/* Canvas for processing */}\r\n                        <canvas\r\n                            ref={canvasRef}\r\n                            className=\"w-48 h-32 object-contain drop-shadow-lg\"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* 2. Cogs Container - Appears & Scales Up after bike */}\r\n                    <div className=\"absolute animate-cogs-pop flex items-center justify-center\">\r\n                        <div className=\"relative w-48 h-48 flex items-center justify-center\">\r\n                            {/* Metallic Gradient Definition */}\r\n                            <svg width=\"0\" height=\"0\">\r\n                                <defs>\r\n                                    <linearGradient id=\"metalGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n                                        <stop offset=\"0%\" stopColor=\"#dbeafe\" /> {/* light blue-100 */}\r\n                                        <stop offset=\"50%\" stopColor=\"#3b82f6\" /> {/* blue-500 */}\r\n                                        <stop offset=\"100%\" stopColor=\"#1e40af\" /> {/* blue-800 */}\r\n                                    </linearGradient>\r\n                                </defs>\r\n                            </svg>\r\n\r\n                            {/* Gear 1 (Largest, Top Left) - Interlocked */}\r\n                            <div className=\"absolute left-[calc(50%-60px)] top-[calc(50%-60px)] animate-spin\" style={{ animationDuration: '4s', animationDirection: 'reverse' }}>\r\n                                <svg width=\"80\" height=\"80\" viewBox=\"0 0 100 100\" className=\"drop-shadow-md\">\r\n                                    <path fill=\"url(#metalGradient)\" d=\"M50 0 L58 10 L70 5 L75 18 L88 15 L88 28 L98 32 L92 42 L100 50 L92 58 L98 68 L88 72 L88 85 L75 82 L70 95 L58 90 L50 100 L42 90 L30 95 L25 82 L12 85 L12 72 L2 68 L8 58 L0 50 L8 42 L2 32 L12 28 L12 15 L25 18 L30 5 L42 10 Z\" />\r\n                                    <circle cx=\"50\" cy=\"50\" r=\"15\" fill=\"#f8fafc\" />\r\n                                    <circle cx=\"50\" cy=\"50\" r=\"8\" fill=\"#94a3b8\" />\r\n                                </svg>\r\n                            </div>\r\n\r\n                            {/* Gear 3 (Small, Center) - Driving Gear */}\r\n                            <div className=\"absolute left-[calc(50%-20px)] top-[calc(50%-20px)] z-10 animate-spin\" style={{ animationDuration: '3s' }}>\r\n                                <svg width=\"40\" height=\"40\" viewBox=\"0 0 100 100\" className=\"drop-shadow-md\">\r\n                                    <path fill=\"url(#metalGradient)\" d=\"M50 0 L58 10 L70 5 L75 18 L88 15 L88 28 L98 32 L92 42 L100 50 L92 58 L98 68 L88 72 L88 85 L75 82 L70 95 L58 90 L50 100 L42 90 L30 95 L25 82 L12 85 L12 72 L2 68 L8 58 L0 50 L8 42 L2 32 L12 28 L12 15 L25 18 L30 5 L42 10 Z\" />\r\n                                    <circle cx=\"50\" cy=\"50\" r=\"12\" fill=\"#f8fafc\" />\r\n                                    <circle cx=\"50\" cy=\"50\" r=\"6\" fill=\"#94a3b8\" />\r\n                                </svg>\r\n                            </div>\r\n\r\n                            {/* Gear 2 (Medium, Bottom Right) - Interlocked */}\r\n                            <div className=\"absolute left-[calc(50%+15px)] top-[calc(50%+15px)] animate-spin\" style={{ animationDuration: '4s', animationDirection: 'reverse' }}>\r\n                                <svg width=\"60\" height=\"60\" viewBox=\"0 0 100 100\" className=\"drop-shadow-md\">\r\n                                    <path fill=\"url(#metalGradient)\" d=\"M50 0 L58 10 L70 5 L75 18 L88 15 L88 28 L98 32 L92 42 L100 50 L92 58 L98 68 L88 72 L88 85 L75 82 L70 95 L58 90 L50 100 L42 90 L30 95 L25 82 L12 85 L12 72 L2 68 L8 58 L0 50 L8 42 L2 32 L12 28 L12 15 L25 18 L30 5 L42 10 Z\" />\r\n                                    <circle cx=\"50\" cy=\"50\" r=\"15\" fill=\"#f8fafc\" />\r\n                                    <circle cx=\"50\" cy=\"50\" r=\"8\" fill=\"#94a3b8\" />\r\n                                </svg>\r\n                            </div>\r\n                        </div>\r\n                        <p className=\"absolute -bottom-6 text-sm font-semibold text-blue-500 animate-pulse\">Processing...</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"text-center space-y-2\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900\">Service in Progress</h2>\r\n                    <p className=\"text-gray-500\">Please complete the service requested by the customer.</p>\r\n                </div>\r\n\r\n                {/* Animated Loading Bar */}\r\n                <div className=\"w-full max-w-md space-y-2\">\r\n                    <div className=\"flex justify-between text-xs text-gray-400 font-semibold uppercase tracking-wider\">\r\n                        <span>Started</span>\r\n                        <span>In Progress</span>\r\n                    </div>\r\n                    <div className=\"h-4 bg-gray-200 rounded-full overflow-hidden relative\">\r\n                        <div className=\"absolute top-0 left-0 bottom-0 bg-blue-600 w-full animate-progress-stripes bg-[length:40px_40px] bg-gradient-to-r from-blue-500 via-blue-600 to-blue-500\"></div>\r\n                        {/* CSS Animation for moving stripes would be ideal, simpler solid bar for now or keyframes in index.css */}\r\n                        <div className=\"absolute top-0 left-0 h-full bg-blue-500 animate-[pulse_2s_cubic-bezier(0.4,0,0.6,1)_infinite] w-full origin-left\"></div>\r\n                    </div>\r\n                    <p className=\"text-center text-sm text-blue-600 font-medium animate-pulse\">Running...</p>\r\n                </div>\r\n\r\n                {error && (\r\n                    <div className=\"p-4 bg-red-50 text-red-700 rounded-md\">\r\n                        {error}\r\n                    </div>\r\n                )}\r\n\r\n                <div className=\"w-full max-w-md pt-8\">\r\n                    <button\r\n                        onClick={handleCompleteService}\r\n                        disabled={loading}\r\n                        className=\"w-full flex items-center justify-center px-6 py-4 border border-transparent text-lg font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 shadow-xl transition-transform transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                    >\r\n                        {loading ? (\r\n                            <>\r\n                                <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                                </svg>\r\n                                Completing...\r\n                            </>\r\n                        ) : (\r\n                            'Mark Service As Completed'\r\n                        )}\r\n                    </button>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ServiceInProgress;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}