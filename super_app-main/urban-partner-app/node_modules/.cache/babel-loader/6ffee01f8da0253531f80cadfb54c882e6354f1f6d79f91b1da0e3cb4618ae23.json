{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = 'http://localhost:5000/api';\nconst URBAN_SERVICES_URL = 'http://localhost:5000/api/urban-services';\nconst getAuthHeaders = () => ({\n  'Authorization': `Bearer ${localStorage.getItem('token') || localStorage.getItem('authToken')}`,\n  'Content-Type': 'application/json'\n});\nexport const partnerService = {\n  // Get partner's bookings\n  getBookings: async (status = '') => {\n    try {\n      const response = await axios.get(`${URBAN_SERVICES_URL}/bookings/partner${status ? `?status=${status}` : ''}`, {\n        headers: getAuthHeaders(),\n        params: {\n          status: status || undefined\n        }\n      });\n      return response.data.data || [];\n    } catch (error) {\n      console.error('Error fetching bookings:', error);\n      // Return empty array instead of throwing to prevent UI errors\n      return [];\n    }\n  },\n  // Accept a booking\n  acceptBooking: async bookingId => {\n    try {\n      const response = await axios.put(`${URBAN_SERVICES_URL}/bookings/${bookingId}/status`, {\n        status: 'confirmed'\n      }, {\n        headers: getAuthHeaders(),\n        validateStatus: status => status < 500 // Don't throw for 4xx errors\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error accepting booking:', error);\n      throw error;\n    }\n  },\n  // Reject a booking\n  rejectBooking: async (bookingId, reason = '') => {\n    try {\n      const response = await axios.put(`${URBAN_SERVICES_URL}/bookings/${bookingId}/status`, {\n        status: 'rejected',\n        cancellationReason: reason || 'Partner rejected the booking'\n      }, {\n        headers: getAuthHeaders(),\n        validateStatus: status => status < 500 // Don't throw for 4xx errors\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error rejecting booking:', error);\n      throw error;\n    }\n  },\n  // Update booking status\n  updateBookingStatus: async (bookingId, status) => {\n    try {\n      const response = await axios.put(`${URBAN_SERVICES_URL}/bookings/${bookingId}/status`, {\n        status\n      }, {\n        headers: getAuthHeaders(),\n        validateStatus: status => status < 500 // Don't throw for 4xx errors\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error updating booking status:', error);\n      throw error;\n    }\n  },\n  // Get partner profile\n  getProfile: async () => {\n    try {\n      const response = await axios.get(`${URBAN_SERVICES_URL}/partners/profile`, {\n        headers: getAuthHeaders()\n      });\n      return response.data.data || {};\n    } catch (error) {\n      console.error('Error fetching partner profile:', error);\n      return {};\n    }\n  },\n  // Get partner stats\n  getStats: async () => {\n    try {\n      // Get dashboard data which includes stats\n      const dashboardResponse = await axios.get(`${URBAN_SERVICES_URL}/partners/dashboard`, {\n        headers: getAuthHeaders()\n      });\n\n      // If dashboard endpoint returns stats directly\n      if (dashboardResponse.data.data && dashboardResponse.data.data.stats) {\n        return dashboardResponse.data.data.stats;\n      }\n\n      // Fallback to calculating stats from bookings if dashboard endpoint is not available\n      const [bookingsResponse, partnerResponse] = await Promise.all([axios.get(`${URBAN_SERVICES_URL}/bookings/partner`, {\n        headers: getAuthHeaders()\n      }), axios.get(`${URBAN_SERVICES_URL}/partners/profile`, {\n        headers: getAuthHeaders()\n      })]);\n      const bookings = bookingsResponse.data.data || [];\n      const partner = partnerResponse.data.data || {};\n\n      // Calculate stats from bookings\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      const todayEarnings = bookings.filter(booking => booking.status === 'completed' && new Date(booking.updatedAt) >= today).reduce((sum, booking) => {\n        var _booking$pricing;\n        return sum + (((_booking$pricing = booking.pricing) === null || _booking$pricing === void 0 ? void 0 : _booking$pricing.totalAmount) || 0);\n      }, 0);\n      const totalEarnings = bookings.filter(booking => booking.status === 'completed').reduce((sum, booking) => {\n        var _booking$pricing2;\n        return sum + (((_booking$pricing2 = booking.pricing) === null || _booking$pricing2 === void 0 ? void 0 : _booking$pricing2.totalAmount) || 0);\n      }, 0);\n      const pendingBookings = bookings.filter(b => b.status === 'pending').length;\n      const completedBookings = bookings.filter(b => b.status === 'completed').length;\n      return {\n        totalBookings: bookings.length,\n        completedBookings,\n        pendingBookings,\n        todayEarnings,\n        totalEarnings,\n        averageRating: partner.rating || 0\n      };\n    } catch (error) {\n      console.error('Error calculating partner stats:', error);\n      // Return default values\n      return {\n        totalBookings: 0,\n        completedBookings: 0,\n        pendingBookings: 0,\n        todayEarnings: 0,\n        totalEarnings: 0,\n        averageRating: 0\n      };\n    }\n  }\n};\nexport default partnerService;","map":{"version":3,"names":["axios","API_BASE_URL","URBAN_SERVICES_URL","getAuthHeaders","localStorage","getItem","partnerService","getBookings","status","response","get","headers","params","undefined","data","error","console","acceptBooking","bookingId","put","validateStatus","rejectBooking","reason","cancellationReason","updateBookingStatus","getProfile","getStats","dashboardResponse","stats","bookingsResponse","partnerResponse","Promise","all","bookings","partner","today","Date","setHours","todayEarnings","filter","booking","updatedAt","reduce","sum","_booking$pricing","pricing","totalAmount","totalEarnings","_booking$pricing2","pendingBookings","b","length","completedBookings","totalBookings","averageRating","rating"],"sources":["D:/SUPER APP MAIN NEW/SUPER APP MAIN NEW/super_app-main/urban-partner-app/src/services/partnerService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = 'http://localhost:5000/api';\r\nconst URBAN_SERVICES_URL = 'http://localhost:5000/api/urban-services';\r\n\r\nconst getAuthHeaders = () => ({\r\n  'Authorization': `Bearer ${localStorage.getItem('token') || localStorage.getItem('authToken')}`,\r\n  'Content-Type': 'application/json'\r\n});\r\n\r\nexport const partnerService = {\r\n  // Get partner's bookings\r\n  getBookings: async (status = '') => {\r\n    try {\r\n      const response = await axios.get(\r\n        `${URBAN_SERVICES_URL}/bookings/partner${status ? `?status=${status}` : ''}`,\r\n        { \r\n          headers: getAuthHeaders(),\r\n          params: { status: status || undefined }\r\n        }\r\n      );\r\n      return response.data.data || [];\r\n    } catch (error) {\r\n      console.error('Error fetching bookings:', error);\r\n      // Return empty array instead of throwing to prevent UI errors\r\n      return [];\r\n    }\r\n  },\r\n\r\n  // Accept a booking\r\n  acceptBooking: async (bookingId) => {\r\n    try {\r\n      const response = await axios.put(\r\n        `${URBAN_SERVICES_URL}/bookings/${bookingId}/status`,\r\n        { status: 'confirmed' },\r\n        { \r\n          headers: getAuthHeaders(),\r\n          validateStatus: (status) => status < 500 // Don't throw for 4xx errors\r\n        }\r\n      );\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error accepting booking:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Reject a booking\r\n  rejectBooking: async (bookingId, reason = '') => {\r\n    try {\r\n      const response = await axios.put(\r\n        `${URBAN_SERVICES_URL}/bookings/${bookingId}/status`,\r\n        { \r\n          status: 'rejected',\r\n          cancellationReason: reason || 'Partner rejected the booking'\r\n        },\r\n        { \r\n          headers: getAuthHeaders(),\r\n          validateStatus: (status) => status < 500 // Don't throw for 4xx errors\r\n        }\r\n      );\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error rejecting booking:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Update booking status\r\n  updateBookingStatus: async (bookingId, status) => {\r\n    try {\r\n      const response = await axios.put(\r\n        `${URBAN_SERVICES_URL}/bookings/${bookingId}/status`,\r\n        { status },\r\n        { \r\n          headers: getAuthHeaders(),\r\n          validateStatus: (status) => status < 500 // Don't throw for 4xx errors\r\n        }\r\n      );\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error updating booking status:', error);\r\n      throw error;\r\n    }\r\n  },\r\n  \r\n  // Get partner profile\r\n  getProfile: async () => {\r\n    try {\r\n      const response = await axios.get(\r\n        `${URBAN_SERVICES_URL}/partners/profile`,\r\n        { headers: getAuthHeaders() }\r\n      );\r\n      return response.data.data || {};\r\n    } catch (error) {\r\n      console.error('Error fetching partner profile:', error);\r\n      return {};\r\n    }\r\n  },\r\n  \r\n  // Get partner stats\r\n  getStats: async () => {\r\n    try {\r\n      // Get dashboard data which includes stats\r\n      const dashboardResponse = await axios.get(\r\n        `${URBAN_SERVICES_URL}/partners/dashboard`,\r\n        { headers: getAuthHeaders() }\r\n      );\r\n      \r\n      // If dashboard endpoint returns stats directly\r\n      if (dashboardResponse.data.data && dashboardResponse.data.data.stats) {\r\n        return dashboardResponse.data.data.stats;\r\n      }\r\n      \r\n      // Fallback to calculating stats from bookings if dashboard endpoint is not available\r\n      const [bookingsResponse, partnerResponse] = await Promise.all([\r\n        axios.get(`${URBAN_SERVICES_URL}/bookings/partner`, { \r\n          headers: getAuthHeaders() \r\n        }),\r\n        axios.get(`${URBAN_SERVICES_URL}/partners/profile`, {\r\n          headers: getAuthHeaders()\r\n        })\r\n      ]);\r\n\r\n      const bookings = bookingsResponse.data.data || [];\r\n      const partner = partnerResponse.data.data || {};\r\n      \r\n      // Calculate stats from bookings\r\n      const today = new Date();\r\n      today.setHours(0, 0, 0, 0);\r\n      \r\n      const todayEarnings = bookings\r\n        .filter(booking => \r\n          booking.status === 'completed' && \r\n          new Date(booking.updatedAt) >= today\r\n        )\r\n        .reduce((sum, booking) => sum + (booking.pricing?.totalAmount || 0), 0);\r\n      \r\n      const totalEarnings = bookings\r\n        .filter(booking => booking.status === 'completed')\r\n        .reduce((sum, booking) => sum + (booking.pricing?.totalAmount || 0), 0);\r\n      \r\n      const pendingBookings = bookings.filter(b => b.status === 'pending').length;\r\n      const completedBookings = bookings.filter(b => b.status === 'completed').length;\r\n      \r\n      return {\r\n        totalBookings: bookings.length,\r\n        completedBookings,\r\n        pendingBookings,\r\n        todayEarnings,\r\n        totalEarnings,\r\n        averageRating: partner.rating || 0\r\n      };\r\n    } catch (error) {\r\n      console.error('Error calculating partner stats:', error);\r\n      // Return default values\r\n      return {\r\n        totalBookings: 0,\r\n        completedBookings: 0,\r\n        pendingBookings: 0,\r\n        todayEarnings: 0,\r\n        totalEarnings: 0,\r\n        averageRating: 0\r\n      };\r\n    }\r\n  }\r\n};\r\n\r\nexport default partnerService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}