{"ast":null,"code":"import _objectSpread from\"C:/Users/THILOCIGAN/Documents/super_app-main_2/super_app-main/urban-partner-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useMemo}from'react';import{useNavigate}from'react-router-dom';import{Tab}from'@headlessui/react';import{UserGroupIcon,ClockIcon,CheckCircleIcon,CurrencyDollarIcon,ExclamationCircleIcon}from'@heroicons/react/24/outline';import{GoogleMap,useJsApiLoader,Marker,Polyline,Autocomplete}from'@react-google-maps/api';import partnerService from'../../services/partnerService';import BookingList from'./BookingList';// BookingCard import removed as it is used inside BookingList\nimport webSocketService from'../../services/websocket';import Navbar from'../common/Navbar';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function classNames(){for(var _len=arguments.length,classes=new Array(_len),_key=0;_key<_len;_key++){classes[_key]=arguments[_key];}return classes.filter(Boolean).join(' ');}// Map Container Style\nconst mapContainerStyle={width:'100%',height:'100%'};// Default center (Chennai)\nconst defaultCenter={lat:13.0827,lng:80.2707};const libraries=['places'];const Dashboard=()=>{const navigate=useNavigate();const[availableBookings,setAvailableBookings]=useState([]);const[myBookings,setMyBookings]=useState([]);const[completedBookings,setCompletedBookings]=useState([]);// New State\nconst[stats,setStats]=useState({totalBookings:0,completedBookings:0,pendingBookings:0,todayEarnings:0,totalEarnings:0,averageRating:0});const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);const[displayAddress,setDisplayAddress]=useState('');// Manual Location Fix State\nconst[showLocationFixModal,setShowLocationFixModal]=useState(false);const[fixCoords,setFixCoords]=useState(null);// { lat, lng }\nconst[fixAddress,setFixAddress]=useState('');const searchBoxRef=useRef(null);// Load Google Maps API\nconst{isLoaded,loadError}=useJsApiLoader({id:'google-map-script',googleMapsApiKey:process.env.REACT_APP_GOOGLE_MAPS_API_KEY,libraries});// Load initial data\nuseEffect(()=>{const loadData=async()=>{try{setIsLoading(true);const[statsData,availableData,myBookingsData]=await Promise.all([partnerService.getStats().catch(()=>({})),partnerService.getAvailableBookings().catch(()=>({data:[]})),partnerService.getBookings().catch(()=>({bookings:[]}))]);setStats(prev=>_objectSpread(_objectSpread({},prev),statsData));setAvailableBookings(availableData.data||[]);// Categorize bookings\nconst allMyBookings=myBookingsData.bookings||[];const active=allMyBookings.filter(b=>b&&['accepted','on_the_way','in_progress'].includes(b.status));const completed=allMyBookings.filter(b=>b&&b.status==='completed');// Update counts based on loaded lists\nconst availableCount=(availableData.data||[]).length;const activeCount=active.length;const completedCount=completed.length;const totalCount=availableCount+activeCount+completedCount;setStats(prev=>_objectSpread(_objectSpread(_objectSpread({},prev),statsData),{},{totalBookings:totalCount// Override backend total with client-side live count of all lists\n}));setAvailableBookings(availableData.data||[]);setMyBookings(active);setCompletedBookings(completed);}catch(err){setError('Failed to load dashboard data');console.error(err);}finally{setIsLoading(false);}};loadData();},[]);// Update Total Bookings count whenever any list changes\nuseEffect(()=>{setStats(prev=>_objectSpread(_objectSpread({},prev),{},{totalBookings:availableBookings.length+myBookings.length+completedBookings.length}));},[availableBookings.length,myBookings.length,completedBookings.length]);// Setup WebSocket subscription\nuseEffect(()=>{const unsubscribe=partnerService.subscribeToBookings(event=>{console.log('WebSocket event received:',event);switch(event.type){case'INITIAL_DATA':// ... (simplified handler or keep existing logic if complex, but here we just follow categorization)\n// For initial data from socket, we might need similar filtering\nconst available=event.available||[];const accepted=event.accepted||[];// Socket usually sends active ones here?\nsetAvailableBookings(available);// Assuming 'accepted' in event means active assigned bookings\nsetMyBookings(accepted.filter(b=>['accepted','on_the_way','in_progress'].includes(b.status)));setCompletedBookings(accepted.filter(b=>b.status==='completed'));break;case'NEW_BOOKING':console.log('NEW_BOOKING received:',event.booking);if(event.booking){setAvailableBookings(prev=>[event.booking,...prev]);}break;case'BOOKING_UPDATED':console.log('BOOKING_UPDATED received:',event.booking);if(!event.booking||!event.booking._id)break;const updatedBooking=event.booking;// Remove from Available (always)\nsetAvailableBookings(prev=>(prev||[]).filter(b=>b&&b._id!==updatedBooking._id));// Handle Categories\nif(updatedBooking.status==='completed'){// Remove from Active\nsetMyBookings(prev=>(prev||[]).filter(b=>b&&b._id!==updatedBooking._id));// Add/Update in Completed\nsetCompletedBookings(prev=>{const current=prev||[];const exists=current.some(b=>b&&b._id===updatedBooking._id);if(exists)return current.map(b=>b._id===updatedBooking._id?updatedBooking:b);return[updatedBooking,...current];});}else if(['accepted','on_the_way','in_progress'].includes(updatedBooking.status)){// Remove from Completed (if somehow it went back?)\nsetCompletedBookings(prev=>(prev||[]).filter(b=>b&&b._id!==updatedBooking._id));// Add/Update in Active\nsetMyBookings(prev=>{const current=prev||[];const exists=current.some(b=>b&&b._id===updatedBooking._id);if(exists)return current.map(b=>b._id===updatedBooking._id?updatedBooking:b);return[updatedBooking,...current];});}else if(updatedBooking.status==='cancelled'||updatedBooking.status==='rejected'){// Remove from all personal lists\nsetMyBookings(prev=>(prev||[]).filter(b=>b&&b._id!==updatedBooking._id));setCompletedBookings(prev=>(prev||[]).filter(b=>b&&b._id!==updatedBooking._id));// If rejected, it might go back to available, but usually NEW_BOOKING handles re-broadcast or backend logic\n}break;case'BOOKING_CANCELLED':console.log('BOOKING_CANCELLED received:',event.bookingId);if(!event.bookingId)break;setAvailableBookings(prev=>(prev||[]).filter(b=>b&&b._id!==event.bookingId));setMyBookings(prev=>(prev||[]).filter(b=>b&&b._id!==event.bookingId));setCompletedBookings(prev=>(prev||[]).filter(b=>b&&b._id!==event.bookingId));break;default:console.log('Unknown event type:',event.type);}});return()=>{if(unsubscribe)unsubscribe();};},[]);// --- Map & Partner Location Logic ---\nconst[partnerLocation,setPartnerLocation]=useState(null);// { lat, lng }\nconst watchIdRef=useRef(null);useEffect(()=>{if('geolocation'in navigator){watchIdRef.current=navigator.geolocation.watchPosition(position=>{setPartnerLocation({lat:position.coords.latitude,lng:position.coords.longitude});},err=>console.error('Error getting location:',err),{enableHighAccuracy:true,maximumAge:10000,timeout:5000});}return()=>{if(watchIdRef.current!==null){navigator.geolocation.clearWatch(watchIdRef.current);}};},[]);const handleAcceptBooking=async bookingId=>{try{await partnerService.updateBookingStatus(bookingId,'accepted');}catch(error){console.error('Error accepting booking:',error);setError('Failed to accept booking. Please try again.');}};const handleRejectBooking=async bookingId=>{try{await partnerService.updateBookingStatus(bookingId,'rejected','Partner rejected');}catch(error){console.error('Error rejecting booking:',error);setError('Failed to reject booking. Please try again.');}};const handleStatusUpdate=async(bookingId,status)=>{try{await partnerService.updateBookingStatus(bookingId,status);// Update local state is handled by WebSocket usually, but successful api call allows local optimism if needed\n}catch(error){console.error(\"Error updating booking status to \".concat(status,\":\"),error);setError(\"Failed to update booking status. Please try again.\");}};// Start Service Modal Logic\nconst[showStartModal,setShowStartModal]=useState(false);const[selectedBooking,setSelectedBooking]=useState(null);// const [displayAddress, setDisplayAddress] = useState('Address not provided'); // Moved up\n// Reverse geocoding to ensure address is always shown if coordinates exist\nuseEffect(()=>{if(showStartModal&&selectedBooking&&isLoaded&&window.google){const loc=getCustomerLocation(selectedBooking);// Set initial value from booking data\nconst initialAddr=selectedBooking.customAddress?\"\".concat(selectedBooking.customAddress.addressLine1,\", \").concat(selectedBooking.customAddress.city):selectedBooking.address||'Address not provided';setDisplayAddress(initialAddr);// If we have coordinates but generic/missing address, fetch it\nif(loc&&(initialAddr==='Address not provided'||!initialAddr)){const geocoder=new window.google.maps.Geocoder();geocoder.geocode({location:loc},(results,status)=>{if(status==='OK'&&results[0]){setDisplayAddress(results[0].formatted_address);}});}}},[showStartModal,selectedBooking,isLoaded]);const handleStartServiceClick=async booking=>{try{// Check if scheduled date matches today\nconst today=new Date();// Reset time portion for accurate date comparison\ntoday.setHours(0,0,0,0);const scheduledDate=new Date(booking.scheduledDate);scheduledDate.setHours(0,0,0,0);if(scheduledDate>today){alert(\"You can only start this service on the scheduled date: \".concat(new Date(booking.scheduledDate).toLocaleDateString()));return;}// If booking is already in-progress, go to the service page directly\nif(booking.status==='in_progress'){navigate(\"/service-in-progress/\".concat(booking._id));return;}// Logic: Just open the modal. Status update to 'on_the_way' happens when \"Navigate\" is clicked.\nsetSelectedBooking(booking);setShowStartModal(true);}catch(error){console.error('Error starting service:',error);}};const handleMarkCompleted=booking=>{if(booking||selectedBooking){const b=booking||selectedBooking;navigate(\"/service-in-progress/\".concat(b._id));setShowStartModal(false);}};const handleReachedLocation=async()=>{if(selectedBooking){try{await handleStatusUpdate(selectedBooking._id,'in_progress');setShowStartModal(false);// Navigate to the dedicated service page which now handles the rest of the flow\nnavigate(\"/service-in-progress/\".concat(selectedBooking._id));}catch(err){console.error(\"Failed to update status to in_progress:\",err);}}};const openNavigation=async()=>{if(!selectedBooking)return;const loc=getCustomerLocation(selectedBooking);if(loc){// 1. Coordinates Exist - Update Status & Open Maps\ntry{if(selectedBooking.status==='accepted'){// Immediately update status to ON_THE_WAY in database\nawait handleStatusUpdate(selectedBooking._id,'on_the_way');setSelectedBooking(prev=>_objectSpread(_objectSpread({},prev),{},{status:'on_the_way'}));}// Open Google Maps Directions\nconst query=\"\".concat(loc.lat,\",\").concat(loc.lng);window.open(\"https://www.google.com/maps/dir/?api=1&destination=\".concat(query),'_blank');}catch(err){console.error(\"Error starting navigation flow:\",err);alert(\"Failed to update status. Navigation blocked.\");}}else{// 2. Fallback - Coordinates DO NOT exist\nconsole.log(\"Location missing, opening fix modal\");// Center map on partner or default\nsetFixCoords(partnerLocation||{lat:13.0827,lng:80.2707});setFixAddress('');// user will search\nsetShowLocationFixModal(true);}};const onSearchLoad=ref=>{searchBoxRef.current=ref;};const onPlaceChanged=()=>{if(searchBoxRef.current){const place=searchBoxRef.current.getPlace();if(place.geometry&&place.geometry.location){const lat=place.geometry.location.lat();const lng=place.geometry.location.lng();setFixCoords({lat,lng});setFixAddress(place.formatted_address||place.name);}}};const handleMapClick=e=>{if(e.latLng){setFixCoords({lat:e.latLng.lat(),lng:e.latLng.lng()});}};const handleConfirmLocation=async()=>{if(!fixCoords||!selectedBooking){alert('Customer location is required to start navigation.');return;}try{// 1. Save Location to Backend\nawait partnerService.updateBookingDestination(selectedBooking._id,{address:fixAddress||\"Pinned Location\",coordinates:fixCoords,city:\"Unknown\",// Simplified\npinCode:\"\"});// 2. Update Status to ON_THE_WAY\nif(selectedBooking.status==='accepted'){await handleStatusUpdate(selectedBooking._id,'on_the_way');setSelectedBooking(prev=>_objectSpread(_objectSpread({},prev),{},{status:'on_the_way'}));}// 3. Update Local Booking Data (Optimistic)\nif(selectedBooking.customAddress){selectedBooking.customAddress.coordinates=fixCoords;selectedBooking.customAddress.addressLine1=fixAddress||\"Pinned Location\";}else{selectedBooking.customAddress={coordinates:fixCoords,addressLine1:fixAddress||\"Pinned Location\"};}// 4. Close Modal & Open Navigation\nsetShowLocationFixModal(false);const query=\"\".concat(fixCoords.lat,\",\").concat(fixCoords.lng);window.open(\"https://www.google.com/maps/dir/?api=1&destination=\".concat(query),'_blank');}catch(err){console.error(\"Failed to update location/status\",err);// alert(\"Failed to save location. Please try again.\");\n}};const statsCards=[{name:'Total Bookings',value:stats.totalBookings,icon:UserGroupIcon,change:'+2.5%',changeType:'positive'},{name:'Pending',value:stats.pendingBookings,icon:ClockIcon,change:'+3.2%',changeType:'positive'},{name:'Completed',value:stats.completedBookings,icon:CheckCircleIcon,change:'+1.1%',changeType:'positive'},{name:'Today\\'s Earnings',value:\"\\u20B9\".concat(stats.todayEarnings.toLocaleString()),icon:CurrencyDollarIcon,change:'+4.6%',changeType:'positive'}];// Helper to safely get customer coordinates or default\nconst getCustomerLocation=booking=>{var _booking$customAddres,_booking$customAddres2,_booking$customAddres3,_booking$customAddres4,_booking$address,_booking$address$coor,_booking$address2,_booking$address2$coo,_booking$customer,_booking$customer$coo,_booking$customer2,_booking$customer2$co;// 1. Check Custom Address Coordinates (Live Location)\nif((booking===null||booking===void 0?void 0:(_booking$customAddres=booking.customAddress)===null||_booking$customAddres===void 0?void 0:(_booking$customAddres2=_booking$customAddres.coordinates)===null||_booking$customAddres2===void 0?void 0:_booking$customAddres2.lat)!==undefined&&(booking===null||booking===void 0?void 0:(_booking$customAddres3=booking.customAddress)===null||_booking$customAddres3===void 0?void 0:(_booking$customAddres4=_booking$customAddres3.coordinates)===null||_booking$customAddres4===void 0?void 0:_booking$customAddres4.lng)!==undefined){return{lat:Number(booking.customAddress.coordinates.lat),lng:Number(booking.customAddress.coordinates.lng)};}// 2. Check Saved Address Coordinates\nif((booking===null||booking===void 0?void 0:(_booking$address=booking.address)===null||_booking$address===void 0?void 0:(_booking$address$coor=_booking$address.coordinates)===null||_booking$address$coor===void 0?void 0:_booking$address$coor.lat)!==undefined&&(booking===null||booking===void 0?void 0:(_booking$address2=booking.address)===null||_booking$address2===void 0?void 0:(_booking$address2$coo=_booking$address2.coordinates)===null||_booking$address2$coo===void 0?void 0:_booking$address2$coo.lng)!==undefined){return{lat:Number(booking.address.coordinates.lat),lng:Number(booking.address.coordinates.lng)};}// 3. Fallback to Customer Profile Coordinates (if any)\nif((booking===null||booking===void 0?void 0:(_booking$customer=booking.customer)===null||_booking$customer===void 0?void 0:(_booking$customer$coo=_booking$customer.coordinates)===null||_booking$customer$coo===void 0?void 0:_booking$customer$coo.lat)!==undefined&&(booking===null||booking===void 0?void 0:(_booking$customer2=booking.customer)===null||_booking$customer2===void 0?void 0:(_booking$customer2$co=_booking$customer2.coordinates)===null||_booking$customer2$co===void 0?void 0:_booking$customer2$co.lng)!==undefined){return{lat:Number(booking.customer.coordinates.lat),lng:Number(booking.customer.coordinates.lng)};}return null;};// Calculate map center\nconst mapCenter=useMemo(()=>{if(partnerLocation)return partnerLocation;if(selectedBooking){const loc=getCustomerLocation(selectedBooking);if(loc)return loc;}return defaultCenter;},[partnerLocation,selectedBooking]);// Route path\nconst routePath=useMemo(()=>{const custLoc=selectedBooking?getCustomerLocation(selectedBooking):null;if(partnerLocation&&custLoc){return[partnerLocation,custLoc];}return[];},[partnerLocation,selectedBooking]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"rounded-md bg-red-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(ExclamationCircleIcon,{className:\"h-5 w-5 text-red-400\",\"aria-hidden\":\"true\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-red-800\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-sm text-red-700\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Please refresh the page or try again later.\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"rounded-md bg-red-50 text-sm font-medium text-red-800 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-offset-2 focus:ring-offset-red-50\",onClick:()=>window.location.reload(),children:\"Refresh\"})})]})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4\",children:statsCards.map(stat=>/*#__PURE__*/_jsx(\"div\",{className:\"bg-white overflow-hidden shadow rounded-lg\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(stat.icon,{className:\"h-6 w-6 text-gray-400\",\"aria-hidden\":\"true\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-5 w-0 flex-1\",children:/*#__PURE__*/_jsxs(\"dl\",{children:[/*#__PURE__*/_jsx(\"dt\",{className:\"text-sm font-medium text-gray-500 truncate\",children:stat.name}),/*#__PURE__*/_jsxs(\"dd\",{className:\"flex items-baseline\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-semibold text-gray-900\",children:stat.value}),stat.change&&/*#__PURE__*/_jsx(\"div\",{className:classNames(stat.changeType==='increase'?'text-green-600':'text-red-600','ml-2 flex items-baseline text-sm font-semibold'),children:stat.change})]})]})})]})})},stat.name))}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow rounded-lg\",children:/*#__PURE__*/_jsxs(Tab.Group,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200\",children:/*#__PURE__*/_jsxs(Tab.List,{as:\"nav\",className:\"-mb-px flex space-x-8 px-6 overflow-x-auto\",children:[/*#__PURE__*/_jsxs(Tab,{className:_ref=>{let{selected}=_ref;return classNames(selected?'border-blue-500 text-blue-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300','whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm outline-none');},children:[\"Available Bookings\",availableBookings.length>0&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\",children:availableBookings.length})]}),/*#__PURE__*/_jsxs(Tab,{className:_ref2=>{let{selected}=_ref2;return classNames(selected?'border-blue-500 text-blue-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300','whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm outline-none');},children:[\"My Bookings\",myBookings.length>0&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:myBookings.length})]}),/*#__PURE__*/_jsxs(Tab,{className:_ref3=>{let{selected}=_ref3;return classNames(selected?'border-blue-500 text-blue-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300','whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm outline-none');},children:[\"Completed Bookings\",completedBookings.length>0&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\",children:completedBookings.length})]})]})}),/*#__PURE__*/_jsxs(Tab.Panels,{className:\"p-6\",children:[/*#__PURE__*/_jsx(Tab.Panel,{children:/*#__PURE__*/_jsx(BookingList,{bookings:availableBookings,emptyMessage:\"No available bookings at the moment\",onAccept:handleAcceptBooking,onReject:handleRejectBooking,onStatusUpdate:handleStatusUpdate,onStartServiceClick:handleStartServiceClick})}),/*#__PURE__*/_jsx(Tab.Panel,{children:/*#__PURE__*/_jsx(BookingList,{bookings:myBookings,emptyMessage:\"You don't have any active bookings\",onStatusUpdate:handleStatusUpdate,onStartServiceClick:handleStartServiceClick})}),/*#__PURE__*/_jsx(Tab.Panel,{children:/*#__PURE__*/_jsx(BookingList,{bookings:completedBookings,emptyMessage:\"No completed bookings yet\",onStatusUpdate:handleStatusUpdate// No Start Service action for completed bookings usually, but passing handler just in case or null\n,onStartServiceClick:null})})]})]})})]}),showStartModal&&selectedBooking&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 flex items-end justify-center bg-black bg-opacity-50 transition-opacity\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white w-full max-w-lg mx-auto rounded-t-2xl shadow-xl transform transition-transform duration-300 ease-in-out h-[85vh] flex flex-col overflow-hidden relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-3 border-b flex justify-between items-center bg-gray-50 z-10\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Live Tracking\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowStartModal(false),className:\"text-gray-500 hover:text-gray-700 p-2\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow relative bg-gray-100 z-0\",children:!isLoaded?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full text-gray-500\",children:\"Loading Google Maps...\"}):/*#__PURE__*/_jsxs(GoogleMap,{mapContainerStyle:mapContainerStyle,center:mapCenter,zoom:13,children:[partnerLocation&&/*#__PURE__*/_jsx(Marker,{position:partnerLocation,label:\"You\"}),getCustomerLocation(selectedBooking)&&/*#__PURE__*/_jsx(Marker,{position:getCustomerLocation(selectedBooking),label:\"Cust\"}),routePath.length>0&&/*#__PURE__*/_jsx(Polyline,{path:routePath,options:{strokeColor:\"#2563EB\",strokeOpacity:0.8,strokeWeight:4}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-5 bg-white border-t space-y-4 z-10\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Destination\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-900 line-clamp-2\",children:displayAddress!=='Address not provided'?displayAddress:(()=>{const loc=getCustomerLocation(selectedBooking);return loc?\"\".concat(loc.lat,\", \").concat(loc.lng):selectedBooking.address||'Address not provided';})()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold animate-pulse\",children:selectedBooking.status==='on_the_way'?'ON THE WAY':selectedBooking.status==='in_progress'?'IN PROGRESS':selectedBooking.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 gap-3 pt-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:openNavigation,className:\"w-full flex items-center justify-center px-4 py-3 border border-gray-300 shadow-sm text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"mr-2 h-5 w-5 text-blue-500\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7\"})}),\"Navigate\"]}),selectedBooking.status==='on_the_way'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleReachedLocation,className:\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 shadow-lg\",children:\"Reached Location\"}),selectedBooking.status==='in_progress'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleMarkCompleted(),className:\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 shadow-lg\",children:\"Mark Service As Completed\"})]})]})]})}),showLocationFixModal&&isLoaded&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg w-full max-w-lg mx-4 overflow-hidden shadow-xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b flex justify-between items-center bg-gray-50\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-lg text-gray-800\",children:\"Set Destination Location\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowLocationFixModal(false),className:\"text-gray-500 hover:text-gray-700 font-bold\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-3\",children:\"Location coordinates are missing. Please search or pin the correct location on the map to start navigation.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 relative\",children:/*#__PURE__*/_jsx(Autocomplete,{onLoad:onSearchLoad,onPlaceChanged:onPlaceChanged,children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search Customer Address...\",className:\"w-full border border-gray-300 rounded-md px-4 py-2 pl-10 focus:ring-2 focus:ring-blue-500 focus:outline-none\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"h-64 w-full rounded-lg overflow-hidden border border-gray-200 relative\",children:[/*#__PURE__*/_jsx(GoogleMap,{mapContainerStyle:{width:'100%',height:'100%'},center:fixCoords||{lat:13.0827,lng:80.2707},zoom:15,onClick:handleMapClick,options:{disableDefaultUI:false,streetViewControl:false,mapTypeControl:false},children:fixCoords&&/*#__PURE__*/_jsx(Marker,{position:fixCoords,draggable:true,onDragEnd:e=>setFixCoords({lat:e.latLng.lat(),lng:e.latLng.lng()}),animation:window.google.maps.Animation.DROP})}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-2 left-0 right-0 text-center pointer-events-none\",children:/*#__PURE__*/_jsx(\"span\",{className:\"bg-white px-2 py-1 rounded shadow text-xs font-semibold text-gray-700\",children:\"Tap map to place pin\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-t bg-gray-50 flex justify-end space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowLocationFixModal(false),className:\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleConfirmLocation,disabled:!fixCoords,className:\"px-4 py-2 rounded-lg text-white text-sm font-medium shadow-sm \".concat(fixCoords?'bg-blue-600 hover:bg-blue-700':'bg-gray-400 cursor-not-allowed'),children:\"Confirm & Navigate\"})]})]})})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","useNavigate","Tab","UserGroupIcon","ClockIcon","CheckCircleIcon","CurrencyDollarIcon","ExclamationCircleIcon","GoogleMap","useJsApiLoader","Marker","Polyline","Autocomplete","partnerService","BookingList","webSocketService","Navbar","jsx","_jsx","jsxs","_jsxs","classNames","_len","arguments","length","classes","Array","_key","filter","Boolean","join","mapContainerStyle","width","height","defaultCenter","lat","lng","libraries","Dashboard","navigate","availableBookings","setAvailableBookings","myBookings","setMyBookings","completedBookings","setCompletedBookings","stats","setStats","totalBookings","pendingBookings","todayEarnings","totalEarnings","averageRating","isLoading","setIsLoading","error","setError","displayAddress","setDisplayAddress","showLocationFixModal","setShowLocationFixModal","fixCoords","setFixCoords","fixAddress","setFixAddress","searchBoxRef","isLoaded","loadError","id","googleMapsApiKey","process","env","REACT_APP_GOOGLE_MAPS_API_KEY","loadData","statsData","availableData","myBookingsData","Promise","all","getStats","catch","getAvailableBookings","data","getBookings","bookings","prev","_objectSpread","allMyBookings","active","b","includes","status","completed","availableCount","activeCount","completedCount","totalCount","err","console","unsubscribe","subscribeToBookings","event","log","type","available","accepted","booking","_id","updatedBooking","current","exists","some","map","bookingId","partnerLocation","setPartnerLocation","watchIdRef","navigator","geolocation","watchPosition","position","coords","latitude","longitude","enableHighAccuracy","maximumAge","timeout","clearWatch","handleAcceptBooking","updateBookingStatus","handleRejectBooking","handleStatusUpdate","concat","showStartModal","setShowStartModal","selectedBooking","setSelectedBooking","window","google","loc","getCustomerLocation","initialAddr","customAddress","addressLine1","city","address","geocoder","maps","Geocoder","geocode","location","results","formatted_address","handleStartServiceClick","today","Date","setHours","scheduledDate","alert","toLocaleDateString","handleMarkCompleted","handleReachedLocation","openNavigation","query","open","onSearchLoad","ref","onPlaceChanged","place","getPlace","geometry","name","handleMapClick","e","latLng","handleConfirmLocation","updateBookingDestination","coordinates","pinCode","statsCards","value","icon","change","changeType","toLocaleString","_booking$customAddres","_booking$customAddres2","_booking$customAddres3","_booking$customAddres4","_booking$address","_booking$address$coor","_booking$address2","_booking$address2$coo","_booking$customer","_booking$customer$coo","_booking$customer2","_booking$customer2$co","undefined","Number","customer","mapCenter","routePath","custLoc","className","children","onClick","reload","stat","Group","List","as","_ref","selected","_ref2","_ref3","Panels","Panel","emptyMessage","onAccept","onReject","onStatusUpdate","onStartServiceClick","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","center","zoom","label","path","options","strokeColor","strokeOpacity","strokeWeight","onLoad","placeholder","disableDefaultUI","streetViewControl","mapTypeControl","draggable","onDragEnd","animation","Animation","DROP","disabled"],"sources":["C:/Users/THILOCIGAN/Documents/super_app-main_2/super_app-main/urban-partner-app/src/components/Partner/Dashboard.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Tab } from '@headlessui/react';\r\nimport {\r\n  UserGroupIcon,\r\n  ClockIcon,\r\n  CheckCircleIcon,\r\n  CurrencyDollarIcon,\r\n  ExclamationCircleIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { GoogleMap, useJsApiLoader, Marker, Polyline, Autocomplete } from '@react-google-maps/api';\r\n\r\nimport partnerService from '../../services/partnerService';\r\nimport BookingList from './BookingList';\r\n// BookingCard import removed as it is used inside BookingList\r\nimport webSocketService from '../../services/websocket';\r\nimport Navbar from '../common/Navbar';\r\n\r\nfunction classNames(...classes) {\r\n  return classes.filter(Boolean).join(' ');\r\n}\r\n\r\n// Map Container Style\r\nconst mapContainerStyle = {\r\n  width: '100%',\r\n  height: '100%'\r\n};\r\n\r\n// Default center (Chennai)\r\nconst defaultCenter = {\r\n  lat: 13.0827,\r\n  lng: 80.2707\r\n};\r\n\r\nconst libraries = ['places'];\r\n\r\nconst Dashboard = () => {\r\n  const navigate = useNavigate();\r\n  const [availableBookings, setAvailableBookings] = useState([]);\r\n  const [myBookings, setMyBookings] = useState([]);\r\n  const [completedBookings, setCompletedBookings] = useState([]); // New State\r\n  const [stats, setStats] = useState({\r\n    totalBookings: 0,\r\n    completedBookings: 0,\r\n    pendingBookings: 0,\r\n    todayEarnings: 0,\r\n    totalEarnings: 0,\r\n    averageRating: 0\r\n  });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  const [displayAddress, setDisplayAddress] = useState('');\r\n\r\n  // Manual Location Fix State\r\n  const [showLocationFixModal, setShowLocationFixModal] = useState(false);\r\n  const [fixCoords, setFixCoords] = useState(null); // { lat, lng }\r\n  const [fixAddress, setFixAddress] = useState('');\r\n  const searchBoxRef = useRef(null);\r\n\r\n  // Load Google Maps API\r\n  const { isLoaded, loadError } = useJsApiLoader({\r\n    id: 'google-map-script',\r\n    googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\r\n    libraries\r\n  });\r\n\r\n  // Load initial data\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        const [statsData, availableData, myBookingsData] = await Promise.all([\r\n          partnerService.getStats().catch(() => ({})),\r\n          partnerService.getAvailableBookings().catch(() => ({ data: [] })),\r\n          partnerService.getBookings().catch(() => ({ bookings: [] }))\r\n        ]);\r\n\r\n        setStats(prev => ({ ...prev, ...statsData }));\r\n        setAvailableBookings(availableData.data || []);\r\n\r\n        // Categorize bookings\r\n        const allMyBookings = myBookingsData.bookings || [];\r\n\r\n        const active = allMyBookings.filter(b =>\r\n          b && ['accepted', 'on_the_way', 'in_progress'].includes(b.status)\r\n        );\r\n\r\n        const completed = allMyBookings.filter(b =>\r\n          b && b.status === 'completed'\r\n        );\r\n\r\n        // Update counts based on loaded lists\r\n        const availableCount = (availableData.data || []).length;\r\n        const activeCount = active.length;\r\n        const completedCount = completed.length;\r\n        const totalCount = availableCount + activeCount + completedCount;\r\n\r\n        setStats(prev => ({\r\n          ...prev,\r\n          ...statsData,\r\n          totalBookings: totalCount // Override backend total with client-side live count of all lists\r\n        }));\r\n        setAvailableBookings(availableData.data || []);\r\n        setMyBookings(active);\r\n        setCompletedBookings(completed);\r\n\r\n      } catch (err) {\r\n        setError('Failed to load dashboard data');\r\n        console.error(err);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  // Update Total Bookings count whenever any list changes\r\n  useEffect(() => {\r\n    setStats(prev => ({\r\n      ...prev,\r\n      totalBookings: availableBookings.length + myBookings.length + completedBookings.length\r\n    }));\r\n  }, [availableBookings.length, myBookings.length, completedBookings.length]);\r\n\r\n  // Setup WebSocket subscription\r\n  useEffect(() => {\r\n    const unsubscribe = partnerService.subscribeToBookings((event) => {\r\n      console.log('WebSocket event received:', event);\r\n\r\n      switch (event.type) {\r\n        case 'INITIAL_DATA':\r\n          // ... (simplified handler or keep existing logic if complex, but here we just follow categorization)\r\n          // For initial data from socket, we might need similar filtering\r\n          const available = event.available || [];\r\n          const accepted = event.accepted || []; // Socket usually sends active ones here?\r\n\r\n          setAvailableBookings(available);\r\n          // Assuming 'accepted' in event means active assigned bookings\r\n          setMyBookings(accepted.filter(b => ['accepted', 'on_the_way', 'in_progress'].includes(b.status)));\r\n          setCompletedBookings(accepted.filter(b => b.status === 'completed'));\r\n          break;\r\n\r\n        case 'NEW_BOOKING':\r\n          console.log('NEW_BOOKING received:', event.booking);\r\n          if (event.booking) {\r\n            setAvailableBookings(prev => [event.booking, ...prev]);\r\n          }\r\n          break;\r\n\r\n        case 'BOOKING_UPDATED':\r\n          console.log('BOOKING_UPDATED received:', event.booking);\r\n          if (!event.booking || !event.booking._id) break;\r\n          const updatedBooking = event.booking;\r\n\r\n          // Remove from Available (always)\r\n          setAvailableBookings(prev => (prev || []).filter(b => b && b._id !== updatedBooking._id));\r\n\r\n          // Handle Categories\r\n          if (updatedBooking.status === 'completed') {\r\n            // Remove from Active\r\n            setMyBookings(prev => (prev || []).filter(b => b && b._id !== updatedBooking._id));\r\n            // Add/Update in Completed\r\n            setCompletedBookings(prev => {\r\n              const current = prev || [];\r\n              const exists = current.some(b => b && b._id === updatedBooking._id);\r\n              if (exists) return current.map(b => b._id === updatedBooking._id ? updatedBooking : b);\r\n              return [updatedBooking, ...current];\r\n            });\r\n          } else if (['accepted', 'on_the_way', 'in_progress'].includes(updatedBooking.status)) {\r\n            // Remove from Completed (if somehow it went back?)\r\n            setCompletedBookings(prev => (prev || []).filter(b => b && b._id !== updatedBooking._id));\r\n            // Add/Update in Active\r\n            setMyBookings(prev => {\r\n              const current = prev || [];\r\n              const exists = current.some(b => b && b._id === updatedBooking._id);\r\n              if (exists) return current.map(b => b._id === updatedBooking._id ? updatedBooking : b);\r\n              return [updatedBooking, ...current];\r\n            });\r\n          } else if (updatedBooking.status === 'cancelled' || updatedBooking.status === 'rejected') {\r\n            // Remove from all personal lists\r\n            setMyBookings(prev => (prev || []).filter(b => b && b._id !== updatedBooking._id));\r\n            setCompletedBookings(prev => (prev || []).filter(b => b && b._id !== updatedBooking._id));\r\n            // If rejected, it might go back to available, but usually NEW_BOOKING handles re-broadcast or backend logic\r\n          }\r\n          break;\r\n\r\n        case 'BOOKING_CANCELLED':\r\n          console.log('BOOKING_CANCELLED received:', event.bookingId);\r\n          if (!event.bookingId) break;\r\n\r\n          setAvailableBookings(prev =>\r\n            (prev || []).filter(b => b && b._id !== event.bookingId)\r\n          );\r\n          setMyBookings(prev =>\r\n            (prev || []).filter(b => b && b._id !== event.bookingId)\r\n          );\r\n          setCompletedBookings(prev => (prev || []).filter(b => b && b._id !== event.bookingId));\r\n          break;\r\n\r\n        default:\r\n          console.log('Unknown event type:', event.type);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      if (unsubscribe) unsubscribe();\r\n    };\r\n  }, []);\r\n\r\n  // --- Map & Partner Location Logic ---\r\n  const [partnerLocation, setPartnerLocation] = useState(null); // { lat, lng }\r\n  const watchIdRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if ('geolocation' in navigator) {\r\n      watchIdRef.current = navigator.geolocation.watchPosition(\r\n        (position) => {\r\n          setPartnerLocation({\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          });\r\n        },\r\n        (err) => console.error('Error getting location:', err),\r\n        { enableHighAccuracy: true, maximumAge: 10000, timeout: 5000 }\r\n      );\r\n    }\r\n    return () => {\r\n      if (watchIdRef.current !== null) {\r\n        navigator.geolocation.clearWatch(watchIdRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const handleAcceptBooking = async (bookingId) => {\r\n    try {\r\n      await partnerService.updateBookingStatus(bookingId, 'accepted');\r\n    } catch (error) {\r\n      console.error('Error accepting booking:', error);\r\n      setError('Failed to accept booking. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleRejectBooking = async (bookingId) => {\r\n    try {\r\n      await partnerService.updateBookingStatus(bookingId, 'rejected', 'Partner rejected');\r\n    } catch (error) {\r\n      console.error('Error rejecting booking:', error);\r\n      setError('Failed to reject booking. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleStatusUpdate = async (bookingId, status) => {\r\n    try {\r\n      await partnerService.updateBookingStatus(bookingId, status);\r\n      // Update local state is handled by WebSocket usually, but successful api call allows local optimism if needed\r\n    } catch (error) {\r\n      console.error(`Error updating booking status to ${status}:`, error);\r\n      setError(`Failed to update booking status. Please try again.`);\r\n    }\r\n  };\r\n\r\n  // Start Service Modal Logic\r\n  const [showStartModal, setShowStartModal] = useState(false);\r\n  const [selectedBooking, setSelectedBooking] = useState(null);\r\n  // const [displayAddress, setDisplayAddress] = useState('Address not provided'); // Moved up\r\n\r\n  // Reverse geocoding to ensure address is always shown if coordinates exist\r\n  useEffect(() => {\r\n    if (showStartModal && selectedBooking && isLoaded && window.google) {\r\n      const loc = getCustomerLocation(selectedBooking);\r\n\r\n      // Set initial value from booking data\r\n      const initialAddr = selectedBooking.customAddress\r\n        ? `${selectedBooking.customAddress.addressLine1}, ${selectedBooking.customAddress.city}`\r\n        : selectedBooking.address || 'Address not provided';\r\n      setDisplayAddress(initialAddr);\r\n\r\n      // If we have coordinates but generic/missing address, fetch it\r\n      if (loc && (initialAddr === 'Address not provided' || !initialAddr)) {\r\n        const geocoder = new window.google.maps.Geocoder();\r\n        geocoder.geocode({ location: loc }, (results, status) => {\r\n          if (status === 'OK' && results[0]) {\r\n            setDisplayAddress(results[0].formatted_address);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }, [showStartModal, selectedBooking, isLoaded]);\r\n\r\n  const handleStartServiceClick = async (booking) => {\r\n    try {\r\n      // Check if scheduled date matches today\r\n      const today = new Date();\r\n      // Reset time portion for accurate date comparison\r\n      today.setHours(0, 0, 0, 0);\r\n\r\n      const scheduledDate = new Date(booking.scheduledDate);\r\n      scheduledDate.setHours(0, 0, 0, 0);\r\n\r\n      if (scheduledDate > today) {\r\n        alert(`You can only start this service on the scheduled date: ${new Date(booking.scheduledDate).toLocaleDateString()}`);\r\n        return;\r\n      }\r\n\r\n      // If booking is already in-progress, go to the service page directly\r\n      if (booking.status === 'in_progress') {\r\n        navigate(`/service-in-progress/${booking._id}`);\r\n        return;\r\n      }\r\n\r\n      // Logic: Just open the modal. Status update to 'on_the_way' happens when \"Navigate\" is clicked.\r\n      setSelectedBooking(booking);\r\n      setShowStartModal(true);\r\n    } catch (error) {\r\n      console.error('Error starting service:', error);\r\n    }\r\n  };\r\n\r\n  const handleMarkCompleted = (booking) => {\r\n    if (booking || selectedBooking) {\r\n      const b = booking || selectedBooking;\r\n      navigate(`/service-in-progress/${b._id}`);\r\n      setShowStartModal(false);\r\n    }\r\n  };\r\n\r\n  const handleReachedLocation = async () => {\r\n    if (selectedBooking) {\r\n      try {\r\n        await handleStatusUpdate(selectedBooking._id, 'in_progress');\r\n        setShowStartModal(false);\r\n        // Navigate to the dedicated service page which now handles the rest of the flow\r\n        navigate(`/service-in-progress/${selectedBooking._id}`);\r\n      } catch (err) {\r\n        console.error(\"Failed to update status to in_progress:\", err);\r\n      }\r\n    }\r\n  };\r\n\r\n  const openNavigation = async () => {\r\n    if (!selectedBooking) return;\r\n\r\n    const loc = getCustomerLocation(selectedBooking);\r\n\r\n    if (loc) {\r\n      // 1. Coordinates Exist - Update Status & Open Maps\r\n      try {\r\n        if (selectedBooking.status === 'accepted') {\r\n          // Immediately update status to ON_THE_WAY in database\r\n          await handleStatusUpdate(selectedBooking._id, 'on_the_way');\r\n          setSelectedBooking(prev => ({ ...prev, status: 'on_the_way' }));\r\n        }\r\n\r\n        // Open Google Maps Directions\r\n        const query = `${loc.lat},${loc.lng}`;\r\n        window.open(`https://www.google.com/maps/dir/?api=1&destination=${query}`, '_blank');\r\n\r\n      } catch (err) {\r\n        console.error(\"Error starting navigation flow:\", err);\r\n        alert(\"Failed to update status. Navigation blocked.\");\r\n      }\r\n\r\n    } else {\r\n      // 2. Fallback - Coordinates DO NOT exist\r\n      console.log(\"Location missing, opening fix modal\");\r\n      // Center map on partner or default\r\n      setFixCoords(partnerLocation || { lat: 13.0827, lng: 80.2707 });\r\n      setFixAddress(''); // user will search\r\n      setShowLocationFixModal(true);\r\n    }\r\n  };\r\n\r\n  const onSearchLoad = (ref) => {\r\n    searchBoxRef.current = ref;\r\n  };\r\n\r\n  const onPlaceChanged = () => {\r\n    if (searchBoxRef.current) {\r\n      const place = searchBoxRef.current.getPlace();\r\n      if (place.geometry && place.geometry.location) {\r\n        const lat = place.geometry.location.lat();\r\n        const lng = place.geometry.location.lng();\r\n        setFixCoords({ lat, lng });\r\n        setFixAddress(place.formatted_address || place.name);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleMapClick = (e) => {\r\n    if (e.latLng) {\r\n      setFixCoords({\r\n        lat: e.latLng.lat(),\r\n        lng: e.latLng.lng()\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleConfirmLocation = async () => {\r\n    if (!fixCoords || !selectedBooking) {\r\n      alert('Customer location is required to start navigation.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // 1. Save Location to Backend\r\n      await partnerService.updateBookingDestination(selectedBooking._id, {\r\n        address: fixAddress || \"Pinned Location\",\r\n        coordinates: fixCoords,\r\n        city: \"Unknown\", // Simplified\r\n        pinCode: \"\"\r\n      });\r\n\r\n      // 2. Update Status to ON_THE_WAY\r\n      if (selectedBooking.status === 'accepted') {\r\n        await handleStatusUpdate(selectedBooking._id, 'on_the_way');\r\n        setSelectedBooking(prev => ({ ...prev, status: 'on_the_way' }));\r\n      }\r\n\r\n      // 3. Update Local Booking Data (Optimistic)\r\n      if (selectedBooking.customAddress) {\r\n        selectedBooking.customAddress.coordinates = fixCoords;\r\n        selectedBooking.customAddress.addressLine1 = fixAddress || \"Pinned Location\";\r\n      } else {\r\n        selectedBooking.customAddress = {\r\n          coordinates: fixCoords,\r\n          addressLine1: fixAddress || \"Pinned Location\"\r\n        };\r\n      }\r\n\r\n      // 4. Close Modal & Open Navigation\r\n      setShowLocationFixModal(false);\r\n\r\n      const query = `${fixCoords.lat},${fixCoords.lng}`;\r\n      window.open(`https://www.google.com/maps/dir/?api=1&destination=${query}`, '_blank');\r\n\r\n    } catch (err) {\r\n      console.error(\"Failed to update location/status\", err);\r\n      // alert(\"Failed to save location. Please try again.\");\r\n    }\r\n  };\r\n\r\n  const statsCards = [\r\n    {\r\n      name: 'Total Bookings',\r\n      value: stats.totalBookings,\r\n      icon: UserGroupIcon,\r\n      change: '+2.5%',\r\n      changeType: 'positive',\r\n    },\r\n    {\r\n      name: 'Pending',\r\n      value: stats.pendingBookings,\r\n      icon: ClockIcon,\r\n      change: '+3.2%',\r\n      changeType: 'positive',\r\n    },\r\n    {\r\n      name: 'Completed',\r\n      value: stats.completedBookings,\r\n      icon: CheckCircleIcon,\r\n      change: '+1.1%',\r\n      changeType: 'positive',\r\n    },\r\n    {\r\n      name: 'Today\\'s Earnings',\r\n      value: `â‚¹${stats.todayEarnings.toLocaleString()}`,\r\n      icon: CurrencyDollarIcon,\r\n      change: '+4.6%',\r\n      changeType: 'positive',\r\n    },\r\n  ];\r\n\r\n  // Helper to safely get customer coordinates or default\r\n  const getCustomerLocation = (booking) => {\r\n    // 1. Check Custom Address Coordinates (Live Location)\r\n    if (booking?.customAddress?.coordinates?.lat !== undefined && booking?.customAddress?.coordinates?.lng !== undefined) {\r\n      return {\r\n        lat: Number(booking.customAddress.coordinates.lat),\r\n        lng: Number(booking.customAddress.coordinates.lng)\r\n      };\r\n    }\r\n    // 2. Check Saved Address Coordinates\r\n    if (booking?.address?.coordinates?.lat !== undefined && booking?.address?.coordinates?.lng !== undefined) {\r\n      return {\r\n        lat: Number(booking.address.coordinates.lat),\r\n        lng: Number(booking.address.coordinates.lng)\r\n      };\r\n    }\r\n    // 3. Fallback to Customer Profile Coordinates (if any)\r\n    if (booking?.customer?.coordinates?.lat !== undefined && booking?.customer?.coordinates?.lng !== undefined) {\r\n      return {\r\n        lat: Number(booking.customer.coordinates.lat),\r\n        lng: Number(booking.customer.coordinates.lng)\r\n      };\r\n    }\r\n    return null;\r\n  };\r\n\r\n  // Calculate map center\r\n  const mapCenter = useMemo(() => {\r\n    if (partnerLocation) return partnerLocation;\r\n    if (selectedBooking) {\r\n      const loc = getCustomerLocation(selectedBooking);\r\n      if (loc) return loc;\r\n    }\r\n    return defaultCenter;\r\n  }, [partnerLocation, selectedBooking]);\r\n\r\n  // Route path\r\n  const routePath = useMemo(() => {\r\n    const custLoc = selectedBooking ? getCustomerLocation(selectedBooking) : null;\r\n    if (partnerLocation && custLoc) {\r\n      return [partnerLocation, custLoc];\r\n    }\r\n    return [];\r\n  }, [partnerLocation, selectedBooking]);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"rounded-md bg-red-50 p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <ExclamationCircleIcon className=\"h-5 w-5 text-red-400\" aria-hidden=\"true\" />\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800\">{error}</h3>\r\n            <div className=\"mt-2 text-sm text-red-700\">\r\n              <p>Please refresh the page or try again later.</p>\r\n            </div>\r\n            <div className=\"mt-4\">\r\n              <button\r\n                type=\"button\"\r\n                className=\"rounded-md bg-red-50 text-sm font-medium text-red-800 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-600 focus:ring-offset-2 focus:ring-offset-red-50\"\r\n                onClick={() => window.location.reload()}\r\n              >\r\n                Refresh\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <Navbar />\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6\">\r\n        {/* Stats */}\r\n        <div className=\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4\">\r\n          {statsCards.map((stat) => (\r\n            <div\r\n              key={stat.name}\r\n              className=\"bg-white overflow-hidden shadow rounded-lg\"\r\n            >\r\n              <div className=\"p-5\">\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"flex-shrink-0\">\r\n                    <stat.icon className=\"h-6 w-6 text-gray-400\" aria-hidden=\"true\" />\r\n                  </div>\r\n                  <div className=\"ml-5 w-0 flex-1\">\r\n                    <dl>\r\n                      <dt className=\"text-sm font-medium text-gray-500 truncate\">\r\n                        {stat.name}\r\n                      </dt>\r\n                      <dd className=\"flex items-baseline\">\r\n                        <div className=\"text-2xl font-semibold text-gray-900\">\r\n                          {stat.value}\r\n                        </div>\r\n                        {stat.change && (\r\n                          <div\r\n                            className={classNames(\r\n                              stat.changeType === 'increase' ? 'text-green-600' : 'text-red-600',\r\n                              'ml-2 flex items-baseline text-sm font-semibold'\r\n                            )}\r\n                          >\r\n                            {stat.change}\r\n                          </div>\r\n                        )}\r\n                      </dd>\r\n                    </dl>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Bookings */}\r\n        <div className=\"bg-white shadow rounded-lg\">\r\n          <Tab.Group>\r\n            <div className=\"border-b border-gray-200\">\r\n              <Tab.List as=\"nav\" className=\"-mb-px flex space-x-8 px-6 overflow-x-auto\">\r\n                <Tab\r\n                  className={({ selected }) =>\r\n                    classNames(\r\n                      selected\r\n                        ? 'border-blue-500 text-blue-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300',\r\n                      'whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm outline-none'\r\n                    )\r\n                  }\r\n                >\r\n                  Available Bookings\r\n                  {availableBookings.length > 0 && (\r\n                    <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\r\n                      {availableBookings.length}\r\n                    </span>\r\n                  )}\r\n                </Tab>\r\n                <Tab\r\n                  className={({ selected }) =>\r\n                    classNames(\r\n                      selected\r\n                        ? 'border-blue-500 text-blue-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300',\r\n                      'whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm outline-none'\r\n                    )\r\n                  }\r\n                >\r\n                  My Bookings\r\n                  {myBookings.length > 0 && (\r\n                    <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\r\n                      {myBookings.length}\r\n                    </span>\r\n                  )}\r\n                </Tab>\r\n                <Tab\r\n                  className={({ selected }) =>\r\n                    classNames(\r\n                      selected\r\n                        ? 'border-blue-500 text-blue-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300',\r\n                      'whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm outline-none'\r\n                    )\r\n                  }\r\n                >\r\n                  Completed Bookings\r\n                  {completedBookings.length > 0 && (\r\n                    <span className=\"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\">\r\n                      {completedBookings.length}\r\n                    </span>\r\n                  )}\r\n                </Tab>\r\n              </Tab.List>\r\n            </div>\r\n            <Tab.Panels className=\"p-6\">\r\n              <Tab.Panel>\r\n                <BookingList\r\n                  bookings={availableBookings}\r\n                  emptyMessage=\"No available bookings at the moment\"\r\n                  onAccept={handleAcceptBooking}\r\n                  onReject={handleRejectBooking}\r\n                  onStatusUpdate={handleStatusUpdate}\r\n                  onStartServiceClick={handleStartServiceClick}\r\n                />\r\n              </Tab.Panel>\r\n              <Tab.Panel>\r\n                <BookingList\r\n                  bookings={myBookings}\r\n                  emptyMessage=\"You don't have any active bookings\"\r\n                  onStatusUpdate={handleStatusUpdate}\r\n                  onStartServiceClick={handleStartServiceClick}\r\n                />\r\n              </Tab.Panel>\r\n              <Tab.Panel>\r\n                <BookingList\r\n                  bookings={completedBookings}\r\n                  emptyMessage=\"No completed bookings yet\"\r\n                  onStatusUpdate={handleStatusUpdate}\r\n                  // No Start Service action for completed bookings usually, but passing handler just in case or null\r\n                  onStartServiceClick={null}\r\n                />\r\n              </Tab.Panel>\r\n            </Tab.Panels>\r\n          </Tab.Group>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Start Service Modal (Bottom Sheet) */}\r\n      {showStartModal && selectedBooking && (\r\n        <div className=\"fixed inset-0 z-50 flex items-end justify-center bg-black bg-opacity-50 transition-opacity\">\r\n          <div className=\"bg-white w-full max-w-lg mx-auto rounded-t-2xl shadow-xl transform transition-transform duration-300 ease-in-out h-[85vh] flex flex-col overflow-hidden relative\">\r\n            {/* Modal Header */}\r\n            <div className=\"px-4 py-3 border-b flex justify-between items-center bg-gray-50 z-10\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">Live Tracking</h3>\r\n              <button\r\n                onClick={() => setShowStartModal(false)}\r\n                className=\"text-gray-500 hover:text-gray-700 p-2\"\r\n              >\r\n                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n\r\n            {/* Map Area */}\r\n            <div className=\"flex-grow relative bg-gray-100 z-0\">\r\n              {!isLoaded ? (\r\n                <div className=\"flex items-center justify-center h-full text-gray-500\">\r\n                  Loading Google Maps...\r\n                </div>\r\n              ) : (\r\n                <GoogleMap\r\n                  mapContainerStyle={mapContainerStyle}\r\n                  center={mapCenter}\r\n                  zoom={13}\r\n                >\r\n                  {/* Partner Location (Use different icon if desired) */}\r\n                  {partnerLocation && (\r\n                    <Marker\r\n                      position={partnerLocation}\r\n                      label=\"You\"\r\n                    />\r\n                  )}\r\n\r\n                  {/* Customer Location */}\r\n                  {getCustomerLocation(selectedBooking) && (\r\n                    <Marker\r\n                      position={getCustomerLocation(selectedBooking)}\r\n                      label=\"Cust\"\r\n                    />\r\n                  )}\r\n\r\n                  {/* Route Line */}\r\n                  {routePath.length > 0 && (\r\n                    <Polyline\r\n                      path={routePath}\r\n                      options={{\r\n                        strokeColor: \"#2563EB\",\r\n                        strokeOpacity: 0.8,\r\n                        strokeWeight: 4,\r\n                      }}\r\n                    />\r\n                  )}\r\n                </GoogleMap>\r\n              )}\r\n            </div>\r\n\r\n            {/* Customer Details & Actions */}\r\n            <div className=\"p-5 bg-white border-t space-y-4 z-10\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm text-gray-500\">Destination</p>\r\n                  <p className=\"font-semibold text-gray-900 line-clamp-2\">\r\n                    {displayAddress !== 'Address not provided' ? displayAddress : (\r\n                      (() => {\r\n                        const loc = getCustomerLocation(selectedBooking);\r\n                        return loc ? `${loc.lat}, ${loc.lng}` : (selectedBooking.address || 'Address not provided');\r\n                      })()\r\n                    )}\r\n                  </p>\r\n                </div>\r\n                <div className=\"bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold animate-pulse\">\r\n                  {selectedBooking.status === 'on_the_way' ? 'ON THE WAY' : selectedBooking.status === 'in_progress' ? 'IN PROGRESS' : selectedBooking.status}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-1 gap-3 pt-2\">\r\n                {/* 1. Navigate Button */}\r\n                <button\r\n                  onClick={openNavigation}\r\n                  className=\"w-full flex items-center justify-center px-4 py-3 border border-gray-300 shadow-sm text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\r\n                >\r\n                  <svg className=\"mr-2 h-5 w-5 text-blue-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7\" />\r\n                  </svg>\r\n                  Navigate\r\n                </button>\r\n\r\n                {/* 2. Reached Location Button - Shown when status is 'on_the_way' */}\r\n                {selectedBooking.status === 'on_the_way' && (\r\n                  <button\r\n                    onClick={handleReachedLocation}\r\n                    className=\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 shadow-lg\"\r\n                  >\r\n                    Reached Location\r\n                  </button>\r\n                )}\r\n\r\n                {/* 3. Mark Service As Completed Button - Shown when status is 'in-progress' (or after being reached) */}\r\n                {selectedBooking.status === 'in_progress' && (\r\n                  <button\r\n                    onClick={() => handleMarkCompleted()}\r\n                    className=\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 shadow-lg\"\r\n                  >\r\n                    Mark Service As Completed\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* Manual Location Fix Modal */}\r\n      {showLocationFixModal && isLoaded && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60]\">\r\n          <div className=\"bg-white rounded-lg w-full max-w-lg mx-4 overflow-hidden shadow-xl\">\r\n            <div className=\"p-4 border-b flex justify-between items-center bg-gray-50\">\r\n              <h3 className=\"font-semibold text-lg text-gray-800\">Set Destination Location</h3>\r\n              <button\r\n                onClick={() => setShowLocationFixModal(false)}\r\n                className=\"text-gray-500 hover:text-gray-700 font-bold\"\r\n              >\r\n                âœ•\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"p-4\">\r\n              <p className=\"text-sm text-gray-600 mb-3\">\r\n                Location coordinates are missing. Please search or pin the correct location on the map to start navigation.\r\n              </p>\r\n\r\n              <div className=\"mb-4 relative\">\r\n                <Autocomplete\r\n                  onLoad={onSearchLoad}\r\n                  onPlaceChanged={onPlaceChanged}\r\n                >\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search Customer Address...\"\r\n                    className=\"w-full border border-gray-300 rounded-md px-4 py-2 pl-10 focus:ring-2 focus:ring-blue-500 focus:outline-none\"\r\n                  />\r\n                </Autocomplete>\r\n              </div>\r\n\r\n              <div className=\"h-64 w-full rounded-lg overflow-hidden border border-gray-200 relative\">\r\n                <GoogleMap\r\n                  mapContainerStyle={{ width: '100%', height: '100%' }}\r\n                  center={fixCoords || { lat: 13.0827, lng: 80.2707 }}\r\n                  zoom={15}\r\n                  onClick={handleMapClick}\r\n                  options={{\r\n                    disableDefaultUI: false,\r\n                    streetViewControl: false,\r\n                    mapTypeControl: false\r\n                  }}\r\n                >\r\n                  {fixCoords && (\r\n                    <Marker\r\n                      position={fixCoords}\r\n                      draggable={true}\r\n                      onDragEnd={(e) => setFixCoords({ lat: e.latLng.lat(), lng: e.latLng.lng() })}\r\n                      animation={window.google.maps.Animation.DROP}\r\n                    />\r\n                  )}\r\n                </GoogleMap>\r\n                <div className=\"absolute bottom-2 left-0 right-0 text-center pointer-events-none\">\r\n                  <span className=\"bg-white px-2 py-1 rounded shadow text-xs font-semibold text-gray-700\">Tap map to place pin</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-4 border-t bg-gray-50 flex justify-end space-x-3\">\r\n              <button\r\n                onClick={() => setShowLocationFixModal(false)}\r\n                className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm font-medium\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleConfirmLocation}\r\n                disabled={!fixCoords}\r\n                className={`px-4 py-2 rounded-lg text-white text-sm font-medium shadow-sm ${fixCoords ? 'bg-blue-600 hover:bg-blue-700' : 'bg-gray-400 cursor-not-allowed'\r\n                  }`}\r\n              >\r\n                Confirm & Navigate\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}